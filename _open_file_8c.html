<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCore: Library/OcFileLib/OpenFile.c File Reference</title>
<link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-zephyr.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-zephyr.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="LogoApprox.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCore
   &#160;<span id="projectnumber">1.0.4</span>
   </div>
   <div id="projectbrief">OpenCore Bootloader</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_open_file_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">OpenFile.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;Uefi.h&gt;</code><br />
<code>#include &lt;Library/BaseLib.h&gt;</code><br />
<code>#include &lt;Library/DebugLib.h&gt;</code><br />
<code>#include &lt;Library/DevicePathLib.h&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_file_lib_8h_source.html">Library/OcFileLib.h</a>&gt;</code><br />
<code>#include &lt;Library/MemoryAllocationLib.h&gt;</code><br />
<code>#include &lt;Library/UefiBootServicesTableLib.h&gt;</code><br />
<code>#include &lt;Protocol/DevicePath.h&gt;</code><br />
<code>#include &lt;Protocol/SimpleFileSystem.h&gt;</code><br />
</div>
<p><a href="_open_file_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae44232ef0a836f32b009d956b4239b51" id="r_ae44232ef0a836f32b009d956b4239b51"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae44232ef0a836f32b009d956b4239b51">OcSafeFileOpen</a> (IN CONST EFI_FILE_PROTOCOL *Directory, OUT EFI_FILE_PROTOCOL **NewHandle, IN CONST CHAR16 *FileName, IN CONST UINT64 OpenMode, IN CONST UINT64 Attributes)</td></tr>
<tr class="separator:ae44232ef0a836f32b009d956b4239b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7664a7aa3e654fe2821205a24b69bf1" id="r_af7664a7aa3e654fe2821205a24b69bf1"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7664a7aa3e654fe2821205a24b69bf1">OcOpenFileByRemainingDevicePath</a> (IN EFI_HANDLE FileSystemHandle, IN CONST EFI_DEVICE_PATH_PROTOCOL *RemainingDevicePath, OUT EFI_FILE_PROTOCOL **File, IN UINT64 OpenMode, IN UINT64 Attributes)</td></tr>
<tr class="separator:af7664a7aa3e654fe2821205a24b69bf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15d8ba4fd700e26ca87c7a4dae49196c" id="r_a15d8ba4fd700e26ca87c7a4dae49196c"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a15d8ba4fd700e26ca87c7a4dae49196c">OcOpenFileByDevicePath</a> (IN OUT EFI_DEVICE_PATH_PROTOCOL **<a class="el" href="_oc_apple_disk_image_block_io_8c.html#a726f080e0c998f2d1a1f752fc17e8c2d">FilePath</a>, OUT EFI_FILE_PROTOCOL **File, IN UINT64 OpenMode, IN UINT64 Attributes)</td></tr>
<tr class="separator:a15d8ba4fd700e26ca87c7a4dae49196c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The UEFI Library provides functions and macros that simplify the development of UEFI Drivers and UEFI Applications. These functions and macros help manage EFI events, build simple locks utilizing EFI Task Priority Levels (TPLs), install EFI Driver Model related protocols, manage Unicode string tables for UEFI Drivers, and print messages on the console output and standard error devices. Copyright (c) 2006 - 2018, Intel Corporation. All rights reserved.<br  />
 This program and the accompanying materials are licensed and made available under the terms and conditions of the BSD License which accompanies this distribution. The full text of the license may be found at <a href="http://opensource.org/licenses/bsd-license.php">http://opensource.org/licenses/bsd-license.php</a>. THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED. </p>

<p class="definition">Definition in file <a class="el" href="_open_file_8c_source.html">OpenFile.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a15d8ba4fd700e26ca87c7a4dae49196c" name="a15d8ba4fd700e26ca87c7a4dae49196c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15d8ba4fd700e26ca87c7a4dae49196c">&#9670;&#160;</a></span>OcOpenFileByDevicePath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI OcOpenFileByDevicePath </td>
          <td>(</td>
          <td class="paramtype">IN OUT EFI_DEVICE_PATH_PROTOCOL **</td>          <td class="paramname"><span class="paramname"><em>FilePath</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT EFI_FILE_PROTOCOL **</td>          <td class="paramname"><span class="paramname"><em>File</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>OpenMode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>Attributes</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Open a file or directory by device path. This is a modified version of EfiOpenFileByDevicePath function, which handles paths with trailing slashes, that cause Open failure on old firmware. EfiOpenFileByDevicePath is additionally not available in UDK.</p>
<p>See more details at: <a href="https://github.com/tianocore/edk2/commit/768b611136d0f2b99a99e446c089d1a30c3fa5d5">https://github.com/tianocore/edk2/commit/768b611136d0f2b99a99e446c089d1a30c3fa5d5</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">FilePath</td><td>Device path protocol. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">File</td><td>Resulting file protocol. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OpenMode</td><td>File open mode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Attributes</td><td>File attributes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>on succesful open. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_open_file_8c_source.html#l00206">206</a> of file <a class="el" href="_open_file_8c_source.html">OpenFile.c</a>.</p>

</div>
</div>
<a id="af7664a7aa3e654fe2821205a24b69bf1" name="af7664a7aa3e654fe2821205a24b69bf1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7664a7aa3e654fe2821205a24b69bf1">&#9670;&#160;</a></span>OcOpenFileByRemainingDevicePath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI OcOpenFileByRemainingDevicePath </td>
          <td>(</td>
          <td class="paramtype">IN EFI_HANDLE</td>          <td class="paramname"><span class="paramname"><em>FileSystemHandle</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST EFI_DEVICE_PATH_PROTOCOL *</td>          <td class="paramname"><span class="paramname"><em>RemainingDevicePath</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT EFI_FILE_PROTOCOL **</td>          <td class="paramname"><span class="paramname"><em>File</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>OpenMode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>Attributes</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Open a file or directory by file system handle and path. See <a class="el" href="_oc_file_lib_8h.html#a15d8ba4fd700e26ca87c7a4dae49196c">OcOpenFileByDevicePath()</a> for more details.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">FileSystemHandle</td><td>File System handle. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RemainingDevicePath</td><td>The remaining Device Path (must be all file path nodes). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">File</td><td>Resulting file protocol. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">OpenMode</td><td>File open mode. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Attributes</td><td>File attributes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>on succesful open. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_open_file_8c_source.html#l00083">83</a> of file <a class="el" href="_open_file_8c_source.html">OpenFile.c</a>.</p>

</div>
</div>
<a id="ae44232ef0a836f32b009d956b4239b51" name="ae44232ef0a836f32b009d956b4239b51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae44232ef0a836f32b009d956b4239b51">&#9670;&#160;</a></span>OcSafeFileOpen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS OcSafeFileOpen </td>
          <td>(</td>
          <td class="paramtype">IN CONST EFI_FILE_PROTOCOL *</td>          <td class="paramname"><span class="paramname"><em>Directory</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT EFI_FILE_PROTOCOL **</td>          <td class="paramname"><span class="paramname"><em>NewHandle</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST CHAR16 *</td>          <td class="paramname"><span class="paramname"><em>FileName</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST UINT64</td>          <td class="paramname"><span class="paramname"><em>OpenMode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST UINT64</td>          <td class="paramname"><span class="paramname"><em>Attributes</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Opens a new file relative to the source file's location. This function is equivalent to EFI_FILE_OPEN but has additional restrictions to provide board compatibility. Currently the only restriction is no trailing slash in the filename due to issues in FAT drivers.</p>
<ul>
<li>Multiple boards, namely ASUS P8H61-M and P8H61-M LX2 will not open directories with trailing slash. It is irrelevant whether front slash is present for them. For example, it means that L"EFI\\OC\\" or L"\EFI\OC\" will both
  fail to open, while L"EFI\OC" and L"\EFI\OC" will open fine.</li>
<li>Most newer boards on APTIO IV do handle directories with trailing slash, however, their driver will modify passed string by removing the slash by \0.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Directory</td><td>File protocol instance of parent directory. </td></tr>
    <tr><td class="paramname">NewHandle</td><td>Pointer for returned handle. </td></tr>
    <tr><td class="paramname">FileName</td><td>Null-terminated file name or relative path. </td></tr>
    <tr><td class="paramname">OpenMode</td><td>File open mode. </td></tr>
    <tr><td class="paramname">Attributes</td><td>Attributes for the newly created file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>for successfully opened file. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_open_file_8c_source.html#l00029">29</a> of file <a class="el" href="_open_file_8c_source.html">OpenFile.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5ad7f572bbca03234e8e621e192fc099.html">Library</a></li><li class="navelem"><a class="el" href="dir_8645bd598b348c9c5520b69ff567ce3b.html">OcFileLib</a></li><li class="navelem"><a class="el" href="_open_file_8c.html">OpenFile.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
