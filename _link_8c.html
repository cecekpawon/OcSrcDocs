<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCore: Library/OcAppleKernelLib/Link.c File Reference</title>
<link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-zephyr.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-zephyr.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="LogoApprox.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCore
   &#160;<span id="projectnumber">1.0.4</span>
   </div>
   <div id="projectbrief">OpenCore Bootloader</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_link_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Link.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;Base.h&gt;</code><br />
<code>#include &lt;<a class="el" href="_apple_kmod_info_8h_source.html">IndustryStandard/AppleKmodInfo.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_apple_macho_image_8h_source.html">IndustryStandard/AppleMachoImage.h</a>&gt;</code><br />
<code>#include &lt;Library/BaseLib.h&gt;</code><br />
<code>#include &lt;Library/BaseMemoryLib.h&gt;</code><br />
<code>#include &lt;Library/BaseOverflowLib.h&gt;</code><br />
<code>#include &lt;Library/DebugLib.h&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_apple_kernel_lib_8h_source.html">Library/OcAppleKernelLib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_macho_lib_8h_source.html">Library/OcMachoLib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_file_lib_8h_source.html">Library/OcFileLib.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="_prelinked_internal_8h_source.html">PrelinkedInternal.h</a>&quot;</code><br />
</div>
<p><a href="_link_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa0821d3f3191e992c5ab6d18f7f36eec" id="r_aa0821d3f3191e992c5ab6d18f7f36eec"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa0821d3f3191e992c5ab6d18f7f36eec">TEXT_SEG_PROT</a>&#160;&#160;&#160;(<a class="el" href="_apple_macho_image_8h.html#a76b4d5c77ac01a929969ac737c6e2ed1">MACH_SEGMENT_VM_PROT_READ</a> | <a class="el" href="_apple_macho_image_8h.html#a9091eec1a065f23e5403557678e96a26">MACH_SEGMENT_VM_PROT_EXECUTE</a>)</td></tr>
<tr class="separator:aa0821d3f3191e992c5ab6d18f7f36eec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05be8691c478b52cfdf01f0dfa610191" id="r_a05be8691c478b52cfdf01f0dfa610191"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a05be8691c478b52cfdf01f0dfa610191">DATA_SEG_PROT</a>&#160;&#160;&#160;(<a class="el" href="_apple_macho_image_8h.html#a76b4d5c77ac01a929969ac737c6e2ed1">MACH_SEGMENT_VM_PROT_READ</a> | <a class="el" href="_apple_macho_image_8h.html#acd89cec4c926a04021773a639938f293">MACH_SEGMENT_VM_PROT_WRITE</a>)</td></tr>
<tr class="separator:a05be8691c478b52cfdf01f0dfa610191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a404dcb59361580840d2baf2341e74f46" id="r_a404dcb59361580840d2baf2341e74f46"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a404dcb59361580840d2baf2341e74f46">MATCH</a>(X)</td></tr>
<tr class="separator:a404dcb59361580840d2baf2341e74f46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abe3944d9297d1de57c50fdad217bb940" id="r_abe3944d9297d1de57c50fdad217bb940"><td class="memItemLeft" align="right" valign="top">STATIC CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___k_e_x_t___s_y_m_b_o_l.html">PRELINKED_KEXT_SYMBOL</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe3944d9297d1de57c50fdad217bb940">InternalOcGetSymbolWorkerName</a> (IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *Kext, IN CONST CHAR8 *LookupValue, IN UINT32 LookupValueLength, IN <a class="el" href="_prelinked_internal_8h.html#a8d3650eb9c3e79c01443ba933d2003cb">OC_GET_SYMBOL_LEVEL</a> SymbolLevel)</td></tr>
<tr class="separator:abe3944d9297d1de57c50fdad217bb940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f852fc9c6789ff24e0487f8094dccdc" id="r_a5f852fc9c6789ff24e0487f8094dccdc"><td class="memItemLeft" align="right" valign="top">STATIC CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___k_e_x_t___s_y_m_b_o_l.html">PRELINKED_KEXT_SYMBOL</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5f852fc9c6789ff24e0487f8094dccdc">InternalOcGetSymbolWorkerValue</a> (IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *Kext, IN UINT64 LookupValue, IN <a class="el" href="_prelinked_internal_8h.html#a8d3650eb9c3e79c01443ba933d2003cb">OC_GET_SYMBOL_LEVEL</a> SymbolLevel)</td></tr>
<tr class="separator:a5f852fc9c6789ff24e0487f8094dccdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a475ff0feb5e6a14bb21d18aba33183c3" id="r_a475ff0feb5e6a14bb21d18aba33183c3"><td class="memItemLeft" align="right" valign="top">CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___k_e_x_t___s_y_m_b_o_l.html">PRELINKED_KEXT_SYMBOL</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a475ff0feb5e6a14bb21d18aba33183c3">InternalOcGetSymbolName</a> (IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *Context, IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *Kext, IN CONST CHAR8 *LookupValue, IN <a class="el" href="_prelinked_internal_8h.html#a8d3650eb9c3e79c01443ba933d2003cb">OC_GET_SYMBOL_LEVEL</a> SymbolLevel)</td></tr>
<tr class="separator:a475ff0feb5e6a14bb21d18aba33183c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68ff0da9e80745e8d55b409fb417df29" id="r_a68ff0da9e80745e8d55b409fb417df29"><td class="memItemLeft" align="right" valign="top">CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___k_e_x_t___s_y_m_b_o_l.html">PRELINKED_KEXT_SYMBOL</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a68ff0da9e80745e8d55b409fb417df29">InternalOcGetSymbolValue</a> (IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *Context, IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *Kext, IN UINT64 LookupValue, IN <a class="el" href="_prelinked_internal_8h.html#a8d3650eb9c3e79c01443ba933d2003cb">OC_GET_SYMBOL_LEVEL</a> SymbolLevel)</td></tr>
<tr class="separator:a68ff0da9e80745e8d55b409fb417df29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae21cec679f435e5090633bcec09d414a" id="r_ae21cec679f435e5090633bcec09d414a"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae21cec679f435e5090633bcec09d414a">InternalSolveSymbolValue</a> (IN BOOLEAN Is32Bit, IN UINT64 Value, OUT <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *Symbol)</td></tr>
<tr class="separator:ae21cec679f435e5090633bcec09d414a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3d50ed4b735115261ca1b5f0451a756" id="r_ae3d50ed4b735115261ca1b5f0451a756"><td class="memItemLeft" align="right" valign="top">STATIC BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae3d50ed4b735115261ca1b5f0451a756">InternalSolveSymbolNonWeak</a> (IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *Context, IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *Kext, IN CONST CHAR8 *Name, IN OUT <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *Symbol)</td></tr>
<tr class="separator:ae3d50ed4b735115261ca1b5f0451a756"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c677e252c431fda60cd97a842f91207" id="r_a4c677e252c431fda60cd97a842f91207"><td class="memItemLeft" align="right" valign="top">STATIC BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4c677e252c431fda60cd97a842f91207">InternalSolveSymbol</a> (IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *Context, IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *Kext, IN CONST CHAR8 *Name, IN OUT <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *Symbol, IN OUT UINT64 *WeakTestValue, IN CONST <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *UndefinedSymbols, IN UINT32 NumUndefinedSymbols)</td></tr>
<tr class="separator:a4c677e252c431fda60cd97a842f91207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac46b961d6da28a61f65b2c0a855e6edc" id="r_ac46b961d6da28a61f65b2c0a855e6edc"><td class="memItemLeft" align="right" valign="top">STATIC BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac46b961d6da28a61f65b2c0a855e6edc">InternalCalculateDisplacementIntel64</a> (IN UINT64 Target, IN UINT64 Adjustment, IN OUT INT32 *Instruction)</td></tr>
<tr class="separator:ac46b961d6da28a61f65b2c0a855e6edc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cea7f5e417bd9acc5f39a7f5ca124e1" id="r_a1cea7f5e417bd9acc5f39a7f5ca124e1"><td class="memItemLeft" align="right" valign="top">STATIC BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1cea7f5e417bd9acc5f39a7f5ca124e1">InternalCalculateTargets</a> (IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *Context, IN OUT <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *Kext, IN UINT64 LoadAddress, IN CONST <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *Relocation, IN CONST <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *NextRelocation OPTIONAL, OUT UINT64 *Target, OUT UINT64 *PairTarget, OUT CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___v_t_a_b_l_e.html">PRELINKED_VTABLE</a> **Vtable OPTIONAL)</td></tr>
<tr class="separator:a1cea7f5e417bd9acc5f39a7f5ca124e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab78aacda69d545416f3128c1936f8074" id="r_ab78aacda69d545416f3128c1936f8074"><td class="memItemLeft" align="right" valign="top">STATIC BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab78aacda69d545416f3128c1936f8074">InternalIsDirectPureVirtualCall</a> (IN BOOLEAN Is32Bit, IN CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___v_t_a_b_l_e.html">PRELINKED_VTABLE</a> *Vtable, IN UINT64 Offset)</td></tr>
<tr class="separator:ab78aacda69d545416f3128c1936f8074"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a775906d2391befd61f4d6284597d4ab4" id="r_a775906d2391befd61f4d6284597d4ab4"><td class="memItemLeft" align="right" valign="top">STATIC UINTN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a775906d2391befd61f4d6284597d4ab4">InternalRelocateRelocation</a> (IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *Context, IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *Kext, IN UINT64 LoadAddress, IN UINT64 RelocationBase, IN CONST <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *Relocation, IN CONST <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *NextRelocation OPTIONAL)</td></tr>
<tr class="separator:a775906d2391befd61f4d6284597d4ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05ba9e8a878acb2d8ce1292c6dc83ad1" id="r_a05ba9e8a878acb2d8ce1292c6dc83ad1"><td class="memItemLeft" align="right" valign="top">STATIC BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a05ba9e8a878acb2d8ce1292c6dc83ad1">InternalRelocateAndCopyRelocations</a> (IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *Context, IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *Kext, IN UINT64 LoadAddress, IN UINT64 RelocationBase, IN CONST <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *SourceRelocations, IN OUT UINT32 *NumRelocations, OUT <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *TargetRelocations)</td></tr>
<tr class="separator:a05ba9e8a878acb2d8ce1292c6dc83ad1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a538411035f2f00e2e91939f26904acd5" id="r_a538411035f2f00e2e91939f26904acd5"><td class="memItemLeft" align="right" valign="top">STATIC BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a538411035f2f00e2e91939f26904acd5">InternalRelocateSymbol</a> (IN <a class="el" href="struct_o_c___m_a_c_h_o___c_o_n_t_e_x_t.html">OC_MACHO_CONTEXT</a> *MachoContext, IN UINT64 LoadAddress, IN OUT <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *Symbol, IN OUT UINT32 *KmodInfoOffset)</td></tr>
<tr class="separator:a538411035f2f00e2e91939f26904acd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48e748faa846e2a4356d0f85fe8a391c" id="r_a48e748faa846e2a4356d0f85fe8a391c"><td class="memItemLeft" align="right" valign="top">STATIC BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48e748faa846e2a4356d0f85fe8a391c">InternalRelocateSymbols</a> (IN <a class="el" href="struct_o_c___m_a_c_h_o___c_o_n_t_e_x_t.html">OC_MACHO_CONTEXT</a> *MachoContext, IN UINT64 LoadAddress, IN UINT32 NumSymbols, IN OUT <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *Symbols, OUT UINT32 *KmodInfoOffset)</td></tr>
<tr class="separator:a48e748faa846e2a4356d0f85fe8a391c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a847fafe5c7651a016b4877830d7a5988" id="r_a847fafe5c7651a016b4877830d7a5988"><td class="memItemLeft" align="right" valign="top">STATIC BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a847fafe5c7651a016b4877830d7a5988">InternalProcessSymbolPointers</a> (IN <a class="el" href="struct_o_c___m_a_c_h_o___c_o_n_t_e_x_t.html">OC_MACHO_CONTEXT</a> *MachoContext, IN CONST <a class="el" href="struct_m_a_c_h___d_y_s_y_m_t_a_b___c_o_m_m_a_n_d.html">MACH_DYSYMTAB_COMMAND</a> *DySymtab, IN UINT64 LoadAddress)</td></tr>
<tr class="separator:a847fafe5c7651a016b4877830d7a5988"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b4738964833b16e31490b3a2a57fddc" id="r_a0b4738964833b16e31490b3a2a57fddc"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b4738964833b16e31490b3a2a57fddc">InternalPrelinkKext</a> (IN OUT <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *Context, IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *Kext, IN UINT64 LoadAddress, IN UINT64 FileOffset)</td></tr>
<tr class="separator:a0b4738964833b16e31490b3a2a57fddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Library handling KEXT prelinking.</p>
<p>Copyright (c) 2018, Download-Fritz. All rights reserved.<br  />
 This program and the accompanying materials are licensed and made available under the terms and conditions of the BSD License which accompanies this distribution. The full text of the license may be found at <a href="http://opensource.org/licenses/bsd-license.php">http://opensource.org/licenses/bsd-license.php</a>.</p>
<p>THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED. </p>

<p class="definition">Definition in file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a05be8691c478b52cfdf01f0dfa610191" name="a05be8691c478b52cfdf01f0dfa610191"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05be8691c478b52cfdf01f0dfa610191">&#9670;&#160;</a></span>DATA_SEG_PROT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATA_SEG_PROT&#160;&#160;&#160;(<a class="el" href="_apple_macho_image_8h.html#a76b4d5c77ac01a929969ac737c6e2ed1">MACH_SEGMENT_VM_PROT_READ</a> | <a class="el" href="_apple_macho_image_8h.html#acd89cec4c926a04021773a639938f293">MACH_SEGMENT_VM_PROT_WRITE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00032">32</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a404dcb59361580840d2baf2341e74f46" name="a404dcb59361580840d2baf2341e74f46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a404dcb59361580840d2baf2341e74f46">&#9670;&#160;</a></span>MATCH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MATCH</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>X</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">if</span> (Symbols[X].Value == LookupValue) { <span class="keywordflow">return</span> &amp;Symbols[X]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa0821d3f3191e992c5ab6d18f7f36eec" name="aa0821d3f3191e992c5ab6d18f7f36eec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0821d3f3191e992c5ab6d18f7f36eec">&#9670;&#160;</a></span>TEXT_SEG_PROT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TEXT_SEG_PROT&#160;&#160;&#160;(<a class="el" href="_apple_macho_image_8h.html#a76b4d5c77ac01a929969ac737c6e2ed1">MACH_SEGMENT_VM_PROT_READ</a> | <a class="el" href="_apple_macho_image_8h.html#a9091eec1a065f23e5403557678e96a26">MACH_SEGMENT_VM_PROT_EXECUTE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00031">31</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac46b961d6da28a61f65b2c0a855e6edc" name="ac46b961d6da28a61f65b2c0a855e6edc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac46b961d6da28a61f65b2c0a855e6edc">&#9670;&#160;</a></span>InternalCalculateDisplacementIntel64()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC BOOLEAN InternalCalculateDisplacementIntel64 </td>
          <td>(</td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>Target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>Adjustment</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT INT32 *</td>          <td class="paramname"><span class="paramname"><em>Instruction</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the target address' displacement for the Intel 64 platform. Instruction will be patched with the resulting address. Logically matches XNU's calculate_displacement_x86_64.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Target</td><td>The target address. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Adjustment</td><td>Adjustment to be subtracted from the displacement. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Instruction</td><td>Pointer to the instruction to be patched.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Returned</td><td>is whether the target instruction has been patched. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00554">554</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a1cea7f5e417bd9acc5f39a7f5ca124e1" name="a1cea7f5e417bd9acc5f39a7f5ca124e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cea7f5e417bd9acc5f39a7f5ca124e1">&#9670;&#160;</a></span>InternalCalculateTargets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC BOOLEAN InternalCalculateTargets </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Kext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>LoadAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *</td>          <td class="paramname"><span class="paramname"><em>Relocation</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *NextRelocation</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT64 *</td>          <td class="paramname"><span class="paramname"><em>Target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT64 *</td>          <td class="paramname"><span class="paramname"><em>PairTarget</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___v_t_a_b_l_e.html">PRELINKED_VTABLE</a> **Vtable</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the target addresses for Relocation and NextRelocation. Logically matches XNU's calculate_targets.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Context</td><td>Prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Kext</td><td>KEXT prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LoadAddress</td><td>The address to be linked against. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Relocation</td><td>The Relocation to be resolved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NextRelocation</td><td>The Relocation following Relocation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Target</td><td>Relocation's target address. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">PairTarget</td><td>NextRelocation's target address. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Vtable</td><td>The VTable described by the symbol referenced by Relocation. NULL, if there is none.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether the operation was completed successfully. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00596">596</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="ab78aacda69d545416f3128c1936f8074" name="ab78aacda69d545416f3128c1936f8074"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab78aacda69d545416f3128c1936f8074">&#9670;&#160;</a></span>InternalIsDirectPureVirtualCall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC BOOLEAN InternalIsDirectPureVirtualCall </td>
          <td>(</td>
          <td class="paramtype">IN BOOLEAN</td>          <td class="paramname"><span class="paramname"><em>Is32Bit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___v_t_a_b_l_e.html">PRELINKED_VTABLE</a> *</td>          <td class="paramname"><span class="paramname"><em>Vtable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>Offset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns whether the VTable entry at Offset is a direct pure virtual call. Logically macthes XNU's check_for_direct_pure_virtual_call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Vtable</td><td>The current VTable to be inspected. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Offset</td><td>The VTable's entry offset. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00741">741</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a475ff0feb5e6a14bb21d18aba33183c3" name="a475ff0feb5e6a14bb21d18aba33183c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a475ff0feb5e6a14bb21d18aba33183c3">&#9670;&#160;</a></span>InternalOcGetSymbolName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___k_e_x_t___s_y_m_b_o_l.html">PRELINKED_KEXT_SYMBOL</a> * InternalOcGetSymbolName </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Kext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST CHAR8 *</td>          <td class="paramname"><span class="paramname"><em>LookupValue</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a8d3650eb9c3e79c01443ba933d2003cb">OC_GET_SYMBOL_LEVEL</a></td>          <td class="paramname"><span class="paramname"><em>SymbolLevel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00191">191</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a68ff0da9e80745e8d55b409fb417df29" name="a68ff0da9e80745e8d55b409fb417df29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68ff0da9e80745e8d55b409fb417df29">&#9670;&#160;</a></span>InternalOcGetSymbolValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___k_e_x_t___s_y_m_b_o_l.html">PRELINKED_KEXT_SYMBOL</a> * InternalOcGetSymbolValue </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Kext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>LookupValue</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a8d3650eb9c3e79c01443ba933d2003cb">OC_GET_SYMBOL_LEVEL</a></td>          <td class="paramname"><span class="paramname"><em>SymbolLevel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00246">246</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="abe3944d9297d1de57c50fdad217bb940" name="abe3944d9297d1de57c50fdad217bb940"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe3944d9297d1de57c50fdad217bb940">&#9670;&#160;</a></span>InternalOcGetSymbolWorkerName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___k_e_x_t___s_y_m_b_o_l.html">PRELINKED_KEXT_SYMBOL</a> * InternalOcGetSymbolWorkerName </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Kext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST CHAR8 *</td>          <td class="paramname"><span class="paramname"><em>LookupValue</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>LookupValueLength</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a8d3650eb9c3e79c01443ba933d2003cb">OC_GET_SYMBOL_LEVEL</a></td>          <td class="paramname"><span class="paramname"><em>SymbolLevel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00040">40</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a5f852fc9c6789ff24e0487f8094dccdc" name="a5f852fc9c6789ff24e0487f8094dccdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f852fc9c6789ff24e0487f8094dccdc">&#9670;&#160;</a></span>InternalOcGetSymbolWorkerValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC CONST <a class="el" href="struct_p_r_e_l_i_n_k_e_d___k_e_x_t___s_y_m_b_o_l.html">PRELINKED_KEXT_SYMBOL</a> * InternalOcGetSymbolWorkerValue </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Kext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>LookupValue</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a8d3650eb9c3e79c01443ba933d2003cb">OC_GET_SYMBOL_LEVEL</a></td>          <td class="paramname"><span class="paramname"><em>SymbolLevel</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00122">122</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a0b4738964833b16e31490b3a2a57fddc" name="a0b4738964833b16e31490b3a2a57fddc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b4738964833b16e31490b3a2a57fddc">&#9670;&#160;</a></span>InternalPrelinkKext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS InternalPrelinkKext </td>
          <td>(</td>
          <td class="paramtype">IN OUT <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Kext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>LoadAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>FileOffset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prelinks the specified KEXT against the specified LoadAddress and the data of its dependencies.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Context</td><td>Prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Kext</td><td>KEXT prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LoadAddress</td><td>The address this KEXT shall be linked against. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">FileOffset</td><td>The file offset of the first segment.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Returned</td><td>is whether the prelinking process has been successful. The state of the KEXT is undefined in case this routine fails. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l01503">1503</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a847fafe5c7651a016b4877830d7a5988" name="a847fafe5c7651a016b4877830d7a5988"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a847fafe5c7651a016b4877830d7a5988">&#9670;&#160;</a></span>InternalProcessSymbolPointers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC BOOLEAN InternalProcessSymbolPointers </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="struct_o_c___m_a_c_h_o___c_o_n_t_e_x_t.html">OC_MACHO_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>MachoContext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST <a class="el" href="struct_m_a_c_h___d_y_s_y_m_t_a_b___c_o_m_m_a_n_d.html">MACH_DYSYMTAB_COMMAND</a> *</td>          <td class="paramname"><span class="paramname"><em>DySymtab</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>LoadAddress</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>process_symbol_pointers </p>

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l01384">1384</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a05ba9e8a878acb2d8ce1292c6dc83ad1" name="a05ba9e8a878acb2d8ce1292c6dc83ad1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05ba9e8a878acb2d8ce1292c6dc83ad1">&#9670;&#160;</a></span>InternalRelocateAndCopyRelocations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC BOOLEAN InternalRelocateAndCopyRelocations </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Kext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>LoadAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>RelocationBase</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *</td>          <td class="paramname"><span class="paramname"><em>SourceRelocations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINT32 *</td>          <td class="paramname"><span class="paramname"><em>NumRelocations</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *</td>          <td class="paramname"><span class="paramname"><em>TargetRelocations</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Relocates all Mach-O Relocations and copies the ones to be preserved after prelinking to TargetRelocations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Context</td><td>Prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Kext</td><td>KEXT prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LoadAddress</td><td>The address to be linked against. dependencies. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RelocationBase</td><td>The Relocations base address. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SourceRelocations</td><td>The Relocations source buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NumRelocations</td><td>On input, the number of source Relocations. On output, the number of Relocations to preserve. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TargetRelocations</td><td>The Relocations destination buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Returned</td><td>is the number of preserved Relocations. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l01106">1106</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a775906d2391befd61f4d6284597d4ab4" name="a775906d2391befd61f4d6284597d4ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a775906d2391befd61f4d6284597d4ab4">&#9670;&#160;</a></span>InternalRelocateRelocation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC UINTN InternalRelocateRelocation </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Kext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>LoadAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>RelocationBase</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *</td>          <td class="paramname"><span class="paramname"><em>Relocation</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST <a class="el" href="struct_m_a_c_h___r_e_l_o_c_a_t_i_o_n___i_n_f_o.html">MACH_RELOCATION_INFO</a> *NextRelocation</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Relocates Relocation against the specified Symtab's Symbol Table and LoadAddress. This logically matches KXLD's generic_process_reloc (for 32-bit) and x86_64_process_reloc (for 64-bit).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Context</td><td>Prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Kext</td><td>KEXT prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LoadAddress</td><td>The address to be linked against. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">RelocationBase</td><td>The Relocations base address. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Relocation</td><td>The Relocation to be processed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NextRelocation</td><td>The Relocation following Relocation.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>The Relocation does not need to be preseved. </td></tr>
    <tr><td class="paramname">1</td><td>The Relocation must be preseved. </td></tr>
    <tr><td class="paramname">0</td><td>| BIT31 The Relocation does not need to be preseved. The next Relocation shall be skipped. </td></tr>
    <tr><td class="paramname">1</td><td>| BIT31 The Relocation must be preseved. The next Relocation shall be skipped. </td></tr>
    <tr><td class="paramname">MAX_UINTN</td><td>The Relocation's target cannot be determined or it is a direct pure virtual call. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00793">793</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a538411035f2f00e2e91939f26904acd5" name="a538411035f2f00e2e91939f26904acd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a538411035f2f00e2e91939f26904acd5">&#9670;&#160;</a></span>InternalRelocateSymbol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC BOOLEAN InternalRelocateSymbol </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="struct_o_c___m_a_c_h_o___c_o_n_t_e_x_t.html">OC_MACHO_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>MachoContext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>LoadAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *</td>          <td class="paramname"><span class="paramname"><em>Symbol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINT32 *</td>          <td class="paramname"><span class="paramname"><em>KmodInfoOffset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l01264">1264</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a48e748faa846e2a4356d0f85fe8a391c" name="a48e748faa846e2a4356d0f85fe8a391c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48e748faa846e2a4356d0f85fe8a391c">&#9670;&#160;</a></span>InternalRelocateSymbols()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC BOOLEAN InternalRelocateSymbols </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="struct_o_c___m_a_c_h_o___c_o_n_t_e_x_t.html">OC_MACHO_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>MachoContext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>LoadAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>NumSymbols</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *</td>          <td class="paramname"><span class="paramname"><em>Symbols</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT32 *</td>          <td class="paramname"><span class="paramname"><em>KmodInfoOffset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l01309">1309</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="a4c677e252c431fda60cd97a842f91207" name="a4c677e252c431fda60cd97a842f91207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c677e252c431fda60cd97a842f91207">&#9670;&#160;</a></span>InternalSolveSymbol()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC BOOLEAN InternalSolveSymbol </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Kext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST CHAR8 *</td>          <td class="paramname"><span class="paramname"><em>Name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *</td>          <td class="paramname"><span class="paramname"><em>Symbol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINT64 *</td>          <td class="paramname"><span class="paramname"><em>WeakTestValue</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *</td>          <td class="paramname"><span class="paramname"><em>UndefinedSymbols</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>NumUndefinedSymbols</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solves Symbol against the specified DefinedSymbols.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Context</td><td>Prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Kext</td><td>KEXT prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Name</td><td>The name of the symbol to resolve against. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Symbol</td><td>The symbol to be resolved. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">WeakTestValue</td><td>Points to the value of the Weak test symbol. If it is 0 on input, it will get assigned the value on the first resolution of a weak symbol. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">UndefinedSymbols</td><td>Array of the Mach-O'S undefined symbols. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NumUndefinedSymbols</td><td>Number of symbols in UndefinedSymbols.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Returned</td><td>is whether the symbol was solved successfully. For weak symbols, this includes solving with _gOSKextUnresolved. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00404">404</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="ae3d50ed4b735115261ca1b5f0451a756" name="ae3d50ed4b735115261ca1b5f0451a756"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3d50ed4b735115261ca1b5f0451a756">&#9670;&#160;</a></span>InternalSolveSymbolNonWeak()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC BOOLEAN InternalSolveSymbolNonWeak </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="struct_p_r_e_l_i_n_k_e_d___c_o_n_t_e_x_t.html">PRELINKED_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_prelinked_internal_8h.html#a5c0471e82fd5e9c37522e5336a538894">PRELINKED_KEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>Kext</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST CHAR8 *</td>          <td class="paramname"><span class="paramname"><em>Name</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *</td>          <td class="paramname"><span class="paramname"><em>Symbol</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Worker function to solve Symbol against the specified DefinedSymbols. It does not consider Symbol might be a weak reference.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Context</td><td>Prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Kext</td><td>KEXT prelinking context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Name</td><td>The name of the symbol to resolve against. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Symbol</td><td>The symbol to be resolved.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Returned</td><td>is whether the symbol was solved successfully. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00325">325</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
<a id="ae21cec679f435e5090633bcec09d414a" name="ae21cec679f435e5090633bcec09d414a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae21cec679f435e5090633bcec09d414a">&#9670;&#160;</a></span>InternalSolveSymbolValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID InternalSolveSymbolValue </td>
          <td>(</td>
          <td class="paramtype">IN BOOLEAN</td>          <td class="paramname"><span class="paramname"><em>Is32Bit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64</td>          <td class="paramname"><span class="paramname"><em>Value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT <a class="el" href="union_m_a_c_h___n_l_i_s_t___a_n_y.html">MACH_NLIST_ANY</a> *</td>          <td class="paramname"><span class="paramname"><em>Symbol</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Patches Symbol with Value and marks it as solved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Is32Bit</td><td>Symbol is 32-bit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Value</td><td>The value to solve Symbol with. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Symbol</td><td>The symbol to solve. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_link_8c_source.html#l00294">294</a> of file <a class="el" href="_link_8c_source.html">Link.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5ad7f572bbca03234e8e621e192fc099.html">Library</a></li><li class="navelem"><a class="el" href="dir_3d313a6dca32667004550d046f132b96.html">OcAppleKernelLib</a></li><li class="navelem"><a class="el" href="_link_8c.html">Link.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
