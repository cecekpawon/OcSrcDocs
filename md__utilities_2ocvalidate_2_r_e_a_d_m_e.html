<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCore: ocvalidate</title>
<link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-zephyr.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-zephyr.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="LogoApprox.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCore
   &#160;<span id="projectnumber">1.0.4</span>
   </div>
   <div id="projectbrief">OpenCore Bootloader</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__utilities_2ocvalidate_2_r_e_a_d_m_e.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">ocvalidate</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Utility to validate whether a <code>config.plist</code> matches requirements and conventions imposed by OpenCore.</p>
<h1><a class="anchor" id="autotoc_md120"></a>
Usage</h1>
<ul>
<li>Pass one single path to <code>config.plist</code> to verify it.</li>
<li>Pass <code>--version</code> for current supported OpenCore version.</li>
</ul>
<h1><a class="anchor" id="autotoc_md121"></a>
Technical background</h1>
<h2><a class="anchor" id="autotoc_md122"></a>
At a glance</h2>
<ul>
<li>ocvalidate firstly calls <code>OcSerializeLib</code> which performs fundamental checks in terms of syntax and semantics. After that, the following will be checked.</li>
<li>The error message <code>&lt;OCS: No schema for xxx&gt;</code> complained by <code>OcSerializeLib</code> indicates unknown keys that can be deprecated in new versions of OpenCore. Such keys should be <em><b>removed</b></em> in order to avoid undefined behaviours.</li>
<li>Under active development, newer versions of OpenCore hardly have backward compatibility at this moment. As a result, please first run <code>ocvalidate --version</code> to check which version of OpenCore is supported, and thus please only use the specific version.</li>
</ul>
<h2><a class="anchor" id="autotoc_md123"></a>
Global Rules</h2>
<ul>
<li>All entries must be set once only. Duplication is strictly prohibited.</li>
<li>All strings (fields with plist <code>String</code> format) throughout the whole config only accept ASCII printable characters at most. Stricter rules may apply. For instance, some fields only accept specified values, as indicated in <a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Configuration.pdf">Configuration.pdf</a>.</li>
<li>All the paths relative to OpenCore root must be less than or equal to 128 bytes (<code>OC_STORAGE_SAFE_PATH_MAX</code>) in total including '\0' terminator.</li>
<li>Most binary patches must have <code>Find</code>, <code>Replace</code>, <code>Mask</code> (if used), and <code>ReplaceMask</code> (if used) identical size set. Also, <code>Find</code> requires <code>Mask</code> (or <code>Replace</code> requires <code>ReplaceMask</code>) to be active (set to non-zero) for corresponding bits.</li>
<li><code>MinKernel</code> and <code>MaxKernel</code> entries should follow conventions specified in <a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Configuration.pdf">Configuration.pdf</a>. (TODO: Bring decent checks for this)</li>
<li><code>MinKernel</code> cannot be a value that is below macOS 10.4 (Darwin version 8).</li>
<li>Entries taking file system path only accept &lsquo;0-9, A-Z, a-z, &rsquo;<em>', '-', '.', '/', and '\'<code>.</code></em></li>
<li><em><code>Device Paths (e.g.</code>PciRoot(0x0)/Pci(0x1b,0x0)<code>) only accept strings in canonic string format.</code></em></li>
<li><em><code>Paths of UEFI Drivers only accept</code>0-9, A-Z, a-z, '</em>', '-', '.', and '/'<code>.</code></li>
<li><code>Entries requiring bitwise operations (e.g.</code>ConsoleAttributes<code>,</code>PickerAttributes<code>, or</code>ScanPolicy<code>) only allow known bits stated in [Configuration.pdf](<a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Configuration.pdf">https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Configuration.pdf</a>) to be set.</code></li>
<li><code>Entries involving GUID (mainly in Section</code>NVRAM`) must have correct format set.</li>
</ul>
<h2><a class="anchor" id="autotoc_md124"></a>
ACPI</h2>
<h3><a class="anchor" id="autotoc_md125"></a>
Add</h3>
<ul>
<li>Entry[N]-&gt;Path: Only <code>.aml</code> and <code>.bin</code> filename suffix are accepted.</li>
</ul>
<h2><a class="anchor" id="autotoc_md126"></a>
Booter</h2>
<h3><a class="anchor" id="autotoc_md127"></a>
MmioWhitelist</h3>
<ul>
<li>Entry[N]-&gt;Enabled: When at least one entry is enabled, <code>DevirtualiseMmio</code> in <code>Booter-&gt;Quirks</code> should be enabled. </li>
</ul>
<h3><a class="anchor" id="autotoc_md128"></a>
Patch</h3>
<ul>
<li>Entry[N]-&gt;Arch: Only <code>Any</code>, <code>i386</code>, or <code>x86_64</code> are accepted.</li>
<li>Entry[N]-&gt;Identifier: Only <code>Any</code>, <code>Apple</code>, or a specified bootloader with <code>.efi</code> sufffix, are accepted. </li>
</ul>
<h3><a class="anchor" id="autotoc_md129"></a>
Quirks</h3>
<ul>
<li>When <code>AllowRelocationBlock</code> is enabled, <code>ProvideCustomSlide</code> should be enabled altogether.</li>
<li>When <code>EnableSafeModeSlide</code> is enabled, <code>ProvideCustomSlide</code> should be enabled altogether.</li>
<li>If <code>ProvideMaxSlide</code> is set to a number greater than zero, <code>ProvideCustomSlide</code> should be enabled altogether.</li>
<li><code>ResizeAppleGpuBars</code> must be set to <code>0</code> or <code>-1</code>.</li>
<li>When <code>DisableVariableWrite</code>, <code>EnableWriteUnprotector</code>, or <code>ProvideCustomSlide</code> is enabled, <code>OpenRuntime.efi</code> should be loaded in <code>UEFI-&gt;Drivers</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md130"></a>
DeviceProperties</h2>
<ul>
<li>Requirements here all follow Global Rules.</li>
</ul>
<h2><a class="anchor" id="autotoc_md131"></a>
Kernel</h2>
<h3><a class="anchor" id="autotoc_md132"></a>
Add</h3>
<ul>
<li>Entry[N]-&gt;Arch: Only <code>Any</code>, <code>i386</code>, or <code>x86_64</code> are accepted.</li>
<li>Entry[N]-&gt;BundlePath: Filename should have <code>.kext</code> suffix.</li>
<li>Entry[N]-&gt;PlistPath: Filename should have <code>.plist</code> suffix.</li>
<li>Entry[N]: If <code>Lilu.kext</code> is used, <code>DisableLinkeditJettison</code> should be enabled in <code>Kernel-&gt;Quirks</code>.</li>
<li><code>BrcmFirmwareRepo.kext</code> must not be injected by OpenCore.</li>
<li>For some known kexts, their <code>BundlePath</code>, <code>ExecutablePath</code>, and <code>PlistPath</code> must match against each other. Current list of rules can be found <a href="https://github.com/acidanthera/OpenCorePkg/blob/master/Utilities/ocvalidate/KextInfo.c">here</a>.</li>
<li>Plugin kext must be placed after parent kext. For example, <a href="https://github.com/acidanthera/Lilu/blob/master/KnownPlugins.md">plugins of Lilu</a> must be placed after <code>Lilu.kext</code>. </li>
</ul>
<h3><a class="anchor" id="autotoc_md133"></a>
Delete</h3>
<ul>
<li>Entry[N]-&gt;Arch: Only <code>Any</code>, <code>i386</code>, or <code>x86_64</code> are accepted.</li>
<li>Entry[N]-&gt;Identifier: At least one dot (<code>.</code>) should exist, because any identifier looks like a domain sequence (<code>vendor.product</code>). </li>
</ul>
<h3><a class="anchor" id="autotoc_md134"></a>
Quirks</h3>
<ul>
<li><code>CustomSMBIOSGuid</code> requires <code>PlatformInfo-&gt;UpdateSMBIOSMode</code> set to <code>Custom</code>.</li>
<li><code>SetApfsTrimTimeout</code> cannot be a value that is greater than <code>MAX_UINT32</code>, or less than <code>-1</code>. </li>
</ul>
<h3><a class="anchor" id="autotoc_md135"></a>
Scheme</h3>
<ul>
<li>KernelArch: Only <code>Auto</code>, <code>i386</code>, <code>i386-user32</code>, or <code>x86_64</code> are accepted.</li>
<li>KernelCache: Only <code>Auto</code>, <code>Cacheless</code>, <code>Mkext</code>, or <code>Prelinked</code> are accepted.</li>
</ul>
<h2><a class="anchor" id="autotoc_md136"></a>
Misc</h2>
<h3><a class="anchor" id="autotoc_md137"></a>
BlessOverride</h3>
<ul>
<li>Entries cannot be <code>\EFI\Microsoft\Boot\bootmgfw.efi</code> or <code>\System\Library\CoreServices\boot.efi</code> since OpenCore knows these paths. </li>
</ul>
<h3><a class="anchor" id="autotoc_md138"></a>
Boot</h3>
<ul>
<li>HibernateMode: Only <code>None</code>, <code>Auto</code>, <code>RTC</code>, or <code>NVRAM</code> are accepted.</li>
<li>PickerMode: Only <code>Builtin</code>, <code>External</code>, or <code>Apple</code> are accepted.</li>
<li><code>PickerAudioAssist</code> requires <code>AudioSupport</code> in <code>UEFI-&gt;Audio</code> to be enabled.</li>
<li>LauncherOption: Only <code>Disabled</code>, <code>Full</code>, <code>Short</code>, or <code>System</code> are accepted.</li>
<li><code>LauncherPath</code> cannot be empty string. </li>
</ul>
<h3><a class="anchor" id="autotoc_md139"></a>
Security</h3>
<ul>
<li>AuthRestart: If enabled, <code>VirtualSMC.kext</code> should be present in <code>Kernel-&gt;Add</code>.</li>
<li>DmgLoading: Only <code>Disabled</code>, <code>Signed</code>, or <code>Any</code> are accepted.</li>
<li>Vault: Only <code>Optional</code>, <code>Basic</code>, or <code>Secure</code> are accepted.</li>
<li>SecureBootModel: Only <code>Default</code>, <code>Disabled</code>, <code>j137</code>, <code>j680</code>, <code>j132</code>, <code>j174</code>, <code>j140k</code>, <code>j780</code>, <code>j213</code>, <code>j140a</code>, <code>j152f</code>, <code>j160</code>, <code>j230k</code>, <code>j214k</code>, <code>j223</code>, <code>j215</code>, <code>j185</code>, <code>j185f</code>, or <code>x86legacy</code> are accepted. </li>
</ul>
<h3><a class="anchor" id="autotoc_md140"></a>
Serial</h3>
<ul>
<li>RegisterAccessWidth: Only <code>8</code> or <code>32</code> are accepted.</li>
<li>BaudRate: Only <code>921600</code>, <code>460800</code>, <code>230400</code>, <code>115200</code>, <code>57600</code>, <code>38400</code>, <code>19200</code>, <code>9600</code>, <code>7200</code>, <code>4800</code>, <code>3600</code>, <code>2400</code>, <code>2000</code>, <code>1800</code>, <code>1200</code>, <code>600</code>, <code>300</code>, <code>150</code>, <code>134</code>, <code>110</code>, <code>75</code>, or <code>50</code> are accepted.</li>
<li>PciDeviceInfo: The last byte must be <code>0xFF</code>.</li>
<li>PciDeviceInfo: Excluding the last byte <code>0xFF</code>, the rest must be divisible by 4.</li>
<li>PciDeviceInfo: Maximum allowed size is 41.</li>
</ul>
<h2><a class="anchor" id="autotoc_md141"></a>
NVRAM</h2>
<ul>
<li>Requirements here all follow Global Rules. In addition, the following keys and values are checked: </li>
</ul>
<h3><a class="anchor" id="autotoc_md142"></a>
gAppleBootVariableGuid (<code>7C436110-AB2A-4BBB-A880-FE41995C9F82</code>)</h3>
<ul>
<li><code>nvda_drv</code> must have type <code>Plist Data</code> with the value of <code>0x30</code> or <code>0x31</code>.</li>
<li><code>boot-args</code> must be an ASCII string (thus <code>Plist String</code>) without trailing <code>\0</code>.</li>
<li><code>bootercfg</code> must be an ASCII string (thus <code>Plist String</code>) without trailing <code>\0</code>.</li>
<li><code>csr-active-config</code> must have type <code>Plist Data</code> and have length of 4 bytes.</li>
<li><code>StartupMute</code> must have type <code>Plist Data</code> and have length of 1 byte.</li>
<li><code>SystemAudioVolume</code> must have type <code>Plist Data</code> and have length of 1 byte. </li>
</ul>
<h3><a class="anchor" id="autotoc_md143"></a>
gAppleVendorVariableGuid (<code>4D1EDE05-38C7-4A6A-9CC6-4BCCA8B38C14</code>)</h3>
<ul>
<li><code>UIScale</code> must have type <code>Plist Data</code> with the value of <code>0x01</code> or <code>0x02</code>.</li>
<li><code>FirmwareFeatures</code> must have type <code>Plist Data</code> and have length of 4 bytes.</li>
<li><code>ExtendedFirmwareFeatures</code> must have type <code>Plist Data</code> and have length of 8 bytes.</li>
<li><code>FirmwareFeaturesMask</code> must have type <code>Plist Data</code> and have length of 4 bytes.</li>
<li><code>ExtendedFirmwareFeatures</code> must have type <code>Plist Data</code> and have length of 8 bytes.</li>
<li><code>DefaultBackgroundColor</code> must have type <code>Plist Data</code> and have length of 4 bytes. Also, its last byte must be <code>0x00</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md144"></a>
PlatformInfo</h2>
<ul>
<li>UpdateSMBIOSMode: Only <code>TryOverwrite</code>, <code>Create</code>, <code>Overwrite</code>, or <code>Custom</code> are accepted. </li>
</ul>
<h3><a class="anchor" id="autotoc_md145"></a>
Generic</h3>
<ul>
<li>SystemProductName: Only real Mac models are accepted.</li>
<li>SystemMemoryStatus: Only <code>Auto</code>, <code>Upgradable</code>, or <code>Soldered</code> are accepted.</li>
<li>SystemUUID: Only empty string, <code>OEM</code> or valid UUID are accepted.</li>
<li>ProcessorType: Only known first byte can be set.</li>
</ul>
<h2><a class="anchor" id="autotoc_md146"></a>
UEFI</h2>
<h3><a class="anchor" id="autotoc_md147"></a>
APFS</h3>
<ul>
<li>When <code>EnableJumpstart</code> is enabled, <code>ScanPolicy</code> in <code>Misc-&gt;Security</code> should have <code>OC_SCAN_ALLOW_FS_APFS</code> (bit 8) set, together with <code>OC_SCAN_FILE_SYSTEM_LOCK</code> (bit 0) set. Or <code>ScanPolicy</code> should be <code>0</code> (failsafe value). </li>
</ul>
<h3><a class="anchor" id="autotoc_md148"></a>
Audio</h3>
<ul>
<li>When <code>AudioSupport</code> is enabled, <code>AudioDevice</code> must be either empty or a valid path.</li>
<li>When <code>AudioSupport</code> is enabled, <code>AudioOutMask</code> must be non-zero. </li>
</ul>
<h3><a class="anchor" id="autotoc_md149"></a>
Quirks</h3>
<ul>
<li>When <code>RequestBootVarRouting</code> is enabled, <code>OpenRuntime.efi</code> should be loaded in <code>UEFI-&gt;Drivers</code>.</li>
<li><code>ResizeGpuBars</code> must be set to an integer value between <code>-1</code> and <code>19</code>. </li>
</ul>
<h3><a class="anchor" id="autotoc_md150"></a>
Drivers</h3>
<ul>
<li>When <code>OpenUsbKbDxe.efi</code> is in use, <code>KeySupport</code> in <code>UEFI-&gt;Input</code> should never be enabled altogether.</li>
<li>When <code>Ps2KeyboardDxe.efi</code> is in use, <code>KeySupport</code> in <code>UEFI-&gt;Input</code> should always be enabled altogether.</li>
<li><code>OpenUsbKbDxe.efi</code> and <code>Ps2KeyboardDxe.efi</code> should never co-exist.</li>
<li>When HFS+ filesystem driver or <code>AudioDxe.efi</code> is in use, <code>ConnectDrivers</code> should be enabled altogether.</li>
<li>When <code>OpenCanopy.efi</code> is in use, <code>PickerMode</code> in <code>Misc-&gt;Boot</code> should be set to <code>External</code>.</li>
<li>When <code>OpenVariableRuntimeDxe.efi</code> is in use, its <code>LoadEarly</code> option must be set to <code>TRUE</code>.</li>
<li><code>OpenRuntime.efi</code> must be placed after <code>OpenVariableRuntimeDxe.efi</code> when both are in use.</li>
<li><code>LoadEarly</code> for any other driver but <code>OpenVariableRuntimeDxe.efi</code> and <code>OpenRuntime.efi</code> must be set to <code>FALSE</code>. </li>
</ul>
<h3><a class="anchor" id="autotoc_md151"></a>
Input</h3>
<ul>
<li>KeySupportMode: Only <code>Auto</code>, <code>V1</code>, <code>V2</code>, or <code>AMI</code> are accepted.</li>
<li>When <code>PointerSupport</code> is enabled, the value of <code>PointerSupportMode</code> should only be <code>ASUS</code>. </li>
</ul>
<h3><a class="anchor" id="autotoc_md152"></a>
Output</h3>
<ul>
<li><code>ClearScreenOnModeSwitch</code>, <code>IgnoreTextInGraphics</code>, <code>ReplaceTabWithSpace</code>, and <code>SanitiseClearScreen</code> only apply to <code>System</code> TextRenderer</li>
<li><code>Resolution</code> should match <code>NUMBERxNUMBER</code> or <code>NUMBERxNUMBER@NUMBER</code> sequences (unless it is an <code>Empty string</code> or is set to <code>Max</code>).</li>
<li><code>UIScale</code> must be set to an integer value between <code>-1</code> and <code>2</code>. </li>
</ul>
<h3><a class="anchor" id="autotoc_md153"></a>
ReservedMemory</h3>
<ul>
<li>Type: Only <code>Reserved</code>, <code>LoaderCode</code>, <code>LoaderData</code>, <code>BootServiceCode</code>, <code>BootServiceData</code>, <code>RuntimeCode</code>, <code>RuntimeData</code>, <code>Available</code>, <code>Persistent</code>, <code>UnusableMemory</code>, <code>ACPIReclaimMemory</code>, <code>ACPIMemoryNVS</code>, <code>MemoryMappedIO</code>, <code>MemoryMappedIOPortSpace</code>, or <code>PalCode</code> are accepted. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
