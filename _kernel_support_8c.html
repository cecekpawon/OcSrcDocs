<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCore: Library/OcAfterBootCompatLib/KernelSupport.c File Reference</title>
<link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-zephyr.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-zephyr.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="LogoApprox.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCore
   &#160;<span id="projectnumber">1.0.4</span>
   </div>
   <div id="projectbrief">OpenCore Bootloader</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_kernel_support_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">KernelSupport.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_boot_compat_internal_8h_source.html">BootCompatInternal.h</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="_oc_variable_8h_source.html">Guid/OcVariable.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_apple_hibernate_8h_source.html">IndustryStandard/AppleHibernate.h</a>&gt;</code><br />
<code>#include &lt;Library/BaseLib.h&gt;</code><br />
<code>#include &lt;Library/BaseMemoryLib.h&gt;</code><br />
<code>#include &lt;Library/DebugLib.h&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_boot_management_lib_8h_source.html">Library/OcBootManagementLib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_device_tree_lib_8h_source.html">Library/OcDeviceTreeLib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_macho_lib_8h_source.html">Library/OcMachoLib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_memory_lib_8h_source.html">Library/OcMemoryLib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_misc_lib_8h_source.html">Library/OcMiscLib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_string_lib_8h_source.html">Library/OcStringLib.h</a>&gt;</code><br />
<code>#include &lt;Library/PrintLib.h&gt;</code><br />
<code>#include &lt;Library/UefiBootServicesTableLib.h&gt;</code><br />
<code>#include &lt;Library/UefiLib.h&gt;</code><br />
<code>#include &lt;Library/UefiRuntimeServicesTableLib.h&gt;</code><br />
</div>
<p><a href="_kernel_support_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a02854197469732d63777ed625de38503" id="r_a02854197469732d63777ed625de38503"><td class="memItemLeft" align="right" valign="top">STATIC VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a02854197469732d63777ed625de38503">ProtectRtMemoryFromRelocation</a> (IN OUT <a class="el" href="_boot_compat_internal_8h.html#a2fa8d028ba2d0f58c1bf78867819aa28">RT_RELOC_PROTECT_DATA</a> *RtReloc, IN UINTN MemoryMapSize, IN UINTN DescriptorSize, IN OUT EFI_MEMORY_DESCRIPTOR *MemoryMap, IN EFI_PHYSICAL_ADDRESS SysTableArea, IN UINTN SysTableAreaSize)</td></tr>
<tr class="separator:a02854197469732d63777ed625de38503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26209a20b6ab61ee254a230b7310f4da" id="r_a26209a20b6ab61ee254a230b7310f4da"><td class="memItemLeft" align="right" valign="top">STATIC EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a26209a20b6ab61ee254a230b7310f4da">PerformRtMemoryVirtualMapping</a> (IN OUT <a class="el" href="_boot_compat_internal_8h.html#a51eaba771635f28e102a14d05351c5ee">KERNEL_SUPPORT_STATE</a> *KernelState, IN UINTN MemoryMapSize, IN UINTN DescriptorSize, IN UINT32 DescriptorVersion, IN EFI_MEMORY_DESCRIPTOR *MemoryMap)</td></tr>
<tr class="separator:a26209a20b6ab61ee254a230b7310f4da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdd28e357e552cf0a6c845466f181a46" id="r_abdd28e357e552cf0a6c845466f181a46"><td class="memItemLeft" align="right" valign="top">STATIC VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abdd28e357e552cf0a6c845466f181a46">RestoreProtectedRtMemoryTypes</a> (IN <a class="el" href="_boot_compat_internal_8h.html#a2fa8d028ba2d0f58c1bf78867819aa28">RT_RELOC_PROTECT_DATA</a> *RtReloc, IN UINTN MemoryMapSize, IN UINTN DescriptorSize, IN OUT EFI_MEMORY_DESCRIPTOR *MemoryMap)</td></tr>
<tr class="separator:abdd28e357e552cf0a6c845466f181a46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af00a48d24de8614731510c941741aee0" id="r_af00a48d24de8614731510c941741aee0"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af00a48d24de8614731510c941741aee0">AppleMapPrepareForBooting</a> (IN OUT <a class="el" href="_boot_compat_internal_8h.html#aaf7c5db4ced13f7b3b45d564c6c6e1f5">BOOT_COMPAT_CONTEXT</a> *BootCompat, IN OUT VOID *BootArgs)</td></tr>
<tr class="separator:af00a48d24de8614731510c941741aee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c7a862bc485c211e510676647e6b683" id="r_a5c7a862bc485c211e510676647e6b683"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c7a862bc485c211e510676647e6b683">AppleMapPrepareForHibernateWake</a> (IN OUT <a class="el" href="_boot_compat_internal_8h.html#aaf7c5db4ced13f7b3b45d564c6c6e1f5">BOOT_COMPAT_CONTEXT</a> *BootCompat, IN UINTN ImageHeaderPage)</td></tr>
<tr class="separator:a5c7a862bc485c211e510676647e6b683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a886d3698fe08ab681b79465b1a1d1111" id="r_a886d3698fe08ab681b79465b1a1d1111"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a886d3698fe08ab681b79465b1a1d1111">AppleMapPrepareMemoryPool</a> (IN OUT <a class="el" href="_boot_compat_internal_8h.html#aaf7c5db4ced13f7b3b45d564c6c6e1f5">BOOT_COMPAT_CONTEXT</a> *BootCompat)</td></tr>
<tr class="separator:a886d3698fe08ab681b79465b1a1d1111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ddfa3b8050b1a30bd985a6894cd2867" id="r_a6ddfa3b8050b1a30bd985a6894cd2867"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ddfa3b8050b1a30bd985a6894cd2867">AppleMapPrepareBooterState</a> (IN OUT <a class="el" href="_boot_compat_internal_8h.html#aaf7c5db4ced13f7b3b45d564c6c6e1f5">BOOT_COMPAT_CONTEXT</a> *BootCompat, IN OUT EFI_LOADED_IMAGE *LoadedImage, IN EFI_GET_MEMORY_MAP GetMemoryMap OPTIONAL)</td></tr>
<tr class="separator:a6ddfa3b8050b1a30bd985a6894cd2867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a813b30a9be7ec549af7304f3a4e637fc" id="r_a813b30a9be7ec549af7304f3a4e637fc"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a813b30a9be7ec549af7304f3a4e637fc">AppleMapPrepareMemState</a> (IN OUT <a class="el" href="_boot_compat_internal_8h.html#aaf7c5db4ced13f7b3b45d564c6c6e1f5">BOOT_COMPAT_CONTEXT</a> *BootCompat, IN UINTN MemoryMapSize, IN UINTN DescriptorSize, IN UINT32 DescriptorVersion, IN EFI_MEMORY_DESCRIPTOR *MemoryMap)</td></tr>
<tr class="separator:a813b30a9be7ec549af7304f3a4e637fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Copyright (C) 2013, dmazar. All rights reserved. Copyright (C) 2019, vit9696. All rights reserved.</p>
<p>All rights reserved.</p>
<p>This program and the accompanying materials are licensed and made available under the terms and conditions of the BSD License which accompanies this distribution. The full text of the license may be found at <a href="http://opensource.org/licenses/bsd-license.php">http://opensource.org/licenses/bsd-license.php</a></p>
<p>THE PROGRAM IS DISTRIBUTED UNDER THE BSD LICENSE ON AN "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED. </p>

<p class="definition">Definition in file <a class="el" href="_kernel_support_8c_source.html">KernelSupport.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6ddfa3b8050b1a30bd985a6894cd2867" name="a6ddfa3b8050b1a30bd985a6894cd2867"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ddfa3b8050b1a30bd985a6894cd2867">&#9670;&#160;</a></span>AppleMapPrepareBooterState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID AppleMapPrepareBooterState </td>
          <td>(</td>
          <td class="paramtype">IN OUT <a class="el" href="_boot_compat_internal_8h.html#aaf7c5db4ced13f7b3b45d564c6c6e1f5">BOOT_COMPAT_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>BootCompat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT EFI_LOADED_IMAGE *</td>          <td class="paramname"><span class="paramname"><em>LoadedImage</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_GET_MEMORY_MAP GetMemoryMap</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prepare environment for Apple UEFI bootloader. See more details inside.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">BootCompat</td><td>Boot compatibility context. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">LoadedImage</td><td>UEFI loaded image protocol instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">GetMemoryMap</td><td>Unmodified GetMemoryMap pointer, optional. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_kernel_support_8c_source.html#l00542">542</a> of file <a class="el" href="_kernel_support_8c_source.html">KernelSupport.c</a>.</p>

</div>
</div>
<a id="af00a48d24de8614731510c941741aee0" name="af00a48d24de8614731510c941741aee0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af00a48d24de8614731510c941741aee0">&#9670;&#160;</a></span>AppleMapPrepareForBooting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID AppleMapPrepareForBooting </td>
          <td>(</td>
          <td class="paramtype">IN OUT <a class="el" href="_boot_compat_internal_8h.html#aaf7c5db4ced13f7b3b45d564c6c6e1f5">BOOT_COMPAT_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>BootCompat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT VOID *</td>          <td class="paramname"><span class="paramname"><em>BootArgs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prepare environment for normal booting. Called when boot.efi jumps to kernel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">BootCompat</td><td>Boot compatibility context. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">BootArgs</td><td>Apple kernel boot arguments. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_kernel_support_8c_source.html#l00325">325</a> of file <a class="el" href="_kernel_support_8c_source.html">KernelSupport.c</a>.</p>

</div>
</div>
<a id="a5c7a862bc485c211e510676647e6b683" name="a5c7a862bc485c211e510676647e6b683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c7a862bc485c211e510676647e6b683">&#9670;&#160;</a></span>AppleMapPrepareForHibernateWake()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID AppleMapPrepareForHibernateWake </td>
          <td>(</td>
          <td class="paramtype">IN OUT <a class="el" href="_boot_compat_internal_8h.html#aaf7c5db4ced13f7b3b45d564c6c6e1f5">BOOT_COMPAT_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>BootCompat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>ImageHeaderPage</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prepare environment for hibernate wake. Called when boot.efi jumps to kernel.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">BootCompat</td><td>Boot compatibility context. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ImageHeaderPage</td><td>Apple hibernate image page number. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_kernel_support_8c_source.html#l00436">436</a> of file <a class="el" href="_kernel_support_8c_source.html">KernelSupport.c</a>.</p>

</div>
</div>
<a id="a886d3698fe08ab681b79465b1a1d1111" name="a886d3698fe08ab681b79465b1a1d1111"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a886d3698fe08ab681b79465b1a1d1111">&#9670;&#160;</a></span>AppleMapPrepareMemoryPool()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID AppleMapPrepareMemoryPool </td>
          <td>(</td>
          <td class="paramtype">IN OUT <a class="el" href="_boot_compat_internal_8h.html#aaf7c5db4ced13f7b3b45d564c6c6e1f5">BOOT_COMPAT_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>BootCompat</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prepare virtual memory management environment for later usage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">BootCompat</td><td>Boot compatibility context. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_kernel_support_8c_source.html#l00518">518</a> of file <a class="el" href="_kernel_support_8c_source.html">KernelSupport.c</a>.</p>

</div>
</div>
<a id="a813b30a9be7ec549af7304f3a4e637fc" name="a813b30a9be7ec549af7304f3a4e637fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a813b30a9be7ec549af7304f3a4e637fc">&#9670;&#160;</a></span>AppleMapPrepareMemState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS AppleMapPrepareMemState </td>
          <td>(</td>
          <td class="paramtype">IN OUT <a class="el" href="_boot_compat_internal_8h.html#aaf7c5db4ced13f7b3b45d564c6c6e1f5">BOOT_COMPAT_CONTEXT</a> *</td>          <td class="paramname"><span class="paramname"><em>BootCompat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>MemoryMapSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>DescriptorSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>DescriptorVersion</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_MEMORY_DESCRIPTOR *</td>          <td class="paramname"><span class="paramname"><em>MemoryMap</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prepare memory state and perform virtual address translation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">BootCompat</td><td>Boot compatibility context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MemoryMapSize</td><td>SetVirtualAddresses memory map size argument. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DescriptorSize</td><td>SetVirtualAddresses descriptor size argument. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DescriptorVersion</td><td>SetVirtualAddresses descriptor version argument. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MemoryMap</td><td>SetVirtualAddresses memory map argument. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_kernel_support_8c_source.html#l00608">608</a> of file <a class="el" href="_kernel_support_8c_source.html">KernelSupport.c</a>.</p>

</div>
</div>
<a id="a26209a20b6ab61ee254a230b7310f4da" name="a26209a20b6ab61ee254a230b7310f4da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26209a20b6ab61ee254a230b7310f4da">&#9670;&#160;</a></span>PerformRtMemoryVirtualMapping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC EFI_STATUS PerformRtMemoryVirtualMapping </td>
          <td>(</td>
          <td class="paramtype">IN OUT <a class="el" href="_boot_compat_internal_8h.html#a51eaba771635f28e102a14d05351c5ee">KERNEL_SUPPORT_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>KernelState</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>MemoryMapSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>DescriptorSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>DescriptorVersion</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_MEMORY_DESCRIPTOR *</td>          <td class="paramname"><span class="paramname"><em>MemoryMap</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy RT flagged areas to separate memmap, define virtual to physical address mapping, and call SetVirtualAddressMap() only with that partial memmap.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">KernelState</td><td>Kernel support state. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MemoryMapSize</td><td>Memory map size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DescriptorSize</td><td>Memory map descriptor size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DescriptorVersion</td><td>Memor map descriptor version. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">MemoryMap</td><td>Complete memory map with all entries.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>on success. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_kernel_support_8c_source.html#l00143">143</a> of file <a class="el" href="_kernel_support_8c_source.html">KernelSupport.c</a>.</p>

</div>
</div>
<a id="a02854197469732d63777ed625de38503" name="a02854197469732d63777ed625de38503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02854197469732d63777ed625de38503">&#9670;&#160;</a></span>ProtectRtMemoryFromRelocation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC VOID ProtectRtMemoryFromRelocation </td>
          <td>(</td>
          <td class="paramtype">IN OUT <a class="el" href="_boot_compat_internal_8h.html#a2fa8d028ba2d0f58c1bf78867819aa28">RT_RELOC_PROTECT_DATA</a> *</td>          <td class="paramname"><span class="paramname"><em>RtReloc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>MemoryMapSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>DescriptorSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT EFI_MEMORY_DESCRIPTOR *</td>          <td class="paramname"><span class="paramname"><em>MemoryMap</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_PHYSICAL_ADDRESS</td>          <td class="paramname"><span class="paramname"><em>SysTableArea</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>SysTableAreaSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Protect RT data from boot.efi relocation by marking them MemMapIO. See more details in the function definition.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">RtReloc</td><td>Relocation entry list to store entry types. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MemoryMapSize</td><td>Memory map size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DescriptorSize</td><td>Memory map descriptor size. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">MemoryMap</td><td>MemoryMap to protect entries in. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SysTableArea</td><td>Special address that should not be protected. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_kernel_support_8c_source.html#l00047">47</a> of file <a class="el" href="_kernel_support_8c_source.html">KernelSupport.c</a>.</p>

</div>
</div>
<a id="abdd28e357e552cf0a6c845466f181a46" name="abdd28e357e552cf0a6c845466f181a46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdd28e357e552cf0a6c845466f181a46">&#9670;&#160;</a></span>RestoreProtectedRtMemoryTypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC VOID RestoreProtectedRtMemoryTypes </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="_boot_compat_internal_8h.html#a2fa8d028ba2d0f58c1bf78867819aa28">RT_RELOC_PROTECT_DATA</a> *</td>          <td class="paramname"><span class="paramname"><em>RtReloc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>MemoryMapSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>DescriptorSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT EFI_MEMORY_DESCRIPTOR *</td>          <td class="paramname"><span class="paramname"><em>MemoryMap</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Revert RT data protected types to let XNU kernel kernel properly map data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">RtReloc</td><td>Relocated entry list with entry types. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MemoryMapSize</td><td>Memory map size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DescriptorSize</td><td>Memory map descriptor size. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">MemoryMap</td><td>MemoryMap to restore protected entries in. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_kernel_support_8c_source.html#l00270">270</a> of file <a class="el" href="_kernel_support_8c_source.html">KernelSupport.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5ad7f572bbca03234e8e621e192fc099.html">Library</a></li><li class="navelem"><a class="el" href="dir_1ad210f664fae1c2f1bca5640a8659e3.html">OcAfterBootCompatLib</a></li><li class="navelem"><a class="el" href="_kernel_support_8c.html">KernelSupport.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
