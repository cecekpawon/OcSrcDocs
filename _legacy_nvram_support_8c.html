<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCore: Library/OcVariableLib/LegacyNvramSupport.c File Reference</title>
<link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-zephyr.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-zephyr.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="LogoApprox.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCore
   &#160;<span id="projectnumber">1.0.4</span>
   </div>
   <div id="projectbrief">OpenCore Bootloader</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_legacy_nvram_support_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">LegacyNvramSupport.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;Uefi.h&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_variable_8h_source.html">Guid/OcVariable.h</a>&gt;</code><br />
<code>#include &lt;Library/BaseLib.h&gt;</code><br />
<code>#include &lt;Library/DebugLib.h&gt;</code><br />
<code>#include &lt;Library/MemoryAllocationLib.h&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_configuration_lib_8h_source.html">Library/OcConfigurationLib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_oc_variable_lib_8h_source.html">Library/OcVariableLib.h</a>&gt;</code><br />
<code>#include &lt;Library/UefiLib.h&gt;</code><br />
<code>#include &lt;Library/UefiRuntimeServicesTableLib.h&gt;</code><br />
</div>
<p><a href="_legacy_nvram_support_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8acab3abd14709f9559b3bdb6af7654a" id="r_a8acab3abd14709f9559b3bdb6af7654a"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8acab3abd14709f9559b3bdb6af7654a">OcProcessVariableGuid</a> (IN CONST CHAR8 *AsciiVariableGuid, OUT GUID *VariableGuid, IN OC_NVRAM_LEGACY_MAP *Schema OPTIONAL, OUT OC_NVRAM_LEGACY_ENTRY **SchemaEntry OPTIONAL)</td></tr>
<tr class="separator:a8acab3abd14709f9559b3bdb6af7654a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c68c280e279508d0dda36c7aa9e823e" id="r_a0c68c280e279508d0dda36c7aa9e823e"><td class="memItemLeft" align="right" valign="top">BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c68c280e279508d0dda36c7aa9e823e">OcVariableIsAllowedBySchemaEntry</a> (IN OC_NVRAM_LEGACY_ENTRY *SchemaEntry, IN EFI_GUID *VariableGuid OPTIONAL, IN CONST VOID *VariableName, IN <a class="el" href="_oc_string_lib_8h.html#acd9ddddb313556513d7388b28b541f30">OC_STRING_FORMAT</a> StringFormat)</td></tr>
<tr class="separator:a0c68c280e279508d0dda36c7aa9e823e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dd0b894dfb60a78891de708cf4d090b" id="r_a4dd0b894dfb60a78891de708cf4d090b"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4dd0b894dfb60a78891de708cf4d090b">OcSetNvramVariable</a> (IN CONST CHAR8 *AsciiVariableName, IN EFI_GUID *VariableGuid, IN UINT32 Attributes, IN UINT32 VariableSize, IN VOID *VariableData, IN OC_NVRAM_LEGACY_ENTRY *SchemaEntry OPTIONAL, IN BOOLEAN Overwrite)</td></tr>
<tr class="separator:a4dd0b894dfb60a78891de708cf4d090b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Supports legacy NVRAM configuration.</p>
<p>Used by OcMainLib and OcVariableRuntimeLib (i.e. emulated NVRAM support).</p>
<p>References OpenCore global config (for legacy NVRAM). Despite referencing global config directly, is required to live outside OcMainLib to avoid having to link OcMainLib and all its dependencies to OpenDuet, when we link OcVariableRuntimeLib to OpenDuet.</p>
<p>Copyright (c) 2019-2022, vit9696, mikebeaton. All rights reserved.<br  />
 SPDX-License-Identifier: BSD-3-Clause </p>

<p class="definition">Definition in file <a class="el" href="_legacy_nvram_support_8c_source.html">LegacyNvramSupport.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a8acab3abd14709f9559b3bdb6af7654a" name="a8acab3abd14709f9559b3bdb6af7654a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8acab3abd14709f9559b3bdb6af7654a">&#9670;&#160;</a></span>OcProcessVariableGuid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS OcProcessVariableGuid </td>
          <td>(</td>
          <td class="paramtype">IN CONST CHAR8 *</td>          <td class="paramname"><span class="paramname"><em>AsciiVariableGuid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT GUID *</td>          <td class="paramname"><span class="paramname"><em>VariableGuid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OC_NVRAM_LEGACY_MAP *Schema</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT OC_NVRAM_LEGACY_ENTRY **SchemaEntry</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test NVRAM GUID against legacy schema.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">AsciiVariableGuid</td><td>Guid to test in ASCII format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">VariableGuid</td><td>On success AsciiVariableGuid converted to GUID format. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Schema</td><td>Schema to test against. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">SchemaEntry</td><td>On success list of allowed variable names for this GUID.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>EFI_SUCCESS If at least some variables are allowed under this GUID. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_legacy_nvram_support_8c_source.html#l00027">27</a> of file <a class="el" href="_legacy_nvram_support_8c_source.html">LegacyNvramSupport.c</a>.</p>

</div>
</div>
<a id="a4dd0b894dfb60a78891de708cf4d090b" name="a4dd0b894dfb60a78891de708cf4d090b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dd0b894dfb60a78891de708cf4d090b">&#9670;&#160;</a></span>OcSetNvramVariable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID OcSetNvramVariable </td>
          <td>(</td>
          <td class="paramtype">IN CONST CHAR8 *</td>          <td class="paramname"><span class="paramname"><em>AsciiVariableName</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_GUID *</td>          <td class="paramname"><span class="paramname"><em>VariableGuid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>Attributes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>VariableSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VOID *</td>          <td class="paramname"><span class="paramname"><em>VariableData</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OC_NVRAM_LEGACY_ENTRY *SchemaEntry</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN</td>          <td class="paramname"><span class="paramname"><em>Overwrite</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set NVRAM variable - for internal use at NVRAM setup only.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">AsciiVariableName</td><td>Variable name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableGuid</td><td>Variably Guid. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Attributes</td><td>Attributes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableSize</td><td>Data size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableData</td><td>Data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SchemaEntry</td><td>Optional schema to filter by. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Overwrite</td><td>If TRUE pre-existing variables can be overwritten. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_legacy_nvram_support_8c_source.html#l00106">106</a> of file <a class="el" href="_legacy_nvram_support_8c_source.html">LegacyNvramSupport.c</a>.</p>

</div>
</div>
<a id="a0c68c280e279508d0dda36c7aa9e823e" name="a0c68c280e279508d0dda36c7aa9e823e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c68c280e279508d0dda36c7aa9e823e">&#9670;&#160;</a></span>OcVariableIsAllowedBySchemaEntry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOLEAN OcVariableIsAllowedBySchemaEntry </td>
          <td>(</td>
          <td class="paramtype">IN OC_NVRAM_LEGACY_ENTRY *</td>          <td class="paramname"><span class="paramname"><em>SchemaEntry</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_GUID *VariableGuid</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CONST VOID *</td>          <td class="paramname"><span class="paramname"><em>VariableName</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="_oc_string_lib_8h.html#acd9ddddb313556513d7388b28b541f30">OC_STRING_FORMAT</a></td>          <td class="paramname"><span class="paramname"><em>StringFormat</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test NVRAM variable name against legacy schema.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">SchemaEntry</td><td>List of allowed names. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableGuid</td><td>Variable GUID (optional, for debug output only). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableName</td><td>Variable name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">StringFormat</td><td>Is VariableName Ascii or Unicode? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_legacy_nvram_support_8c_source.html#l00058">58</a> of file <a class="el" href="_legacy_nvram_support_8c_source.html">LegacyNvramSupport.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_5ad7f572bbca03234e8e621e192fc099.html">Library</a></li><li class="navelem"><a class="el" href="dir_d624e875696f839dc1dc6da4a56cb6c1.html">OcVariableLib</a></li><li class="navelem"><a class="el" href="_legacy_nvram_support_8c.html">LegacyNvramSupport.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
