<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCore: Platform/OpenVariableRuntimeDxe/Variable.c File Reference</title>
<link href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-zephyr.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-zephyr.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="LogoApprox.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCore
   &#160;<span id="projectnumber">1.0.4</span>
   </div>
   <div id="projectbrief">OpenCore Bootloader</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_variable_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Variable.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_variable_8h_source.html">Variable.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_variable_non_volatile_8h_source.html">VariableNonVolatile.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_variable_parsing_8h_source.html">VariableParsing.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_variable_runtime_cache_8h_source.html">VariableRuntimeCache.h</a>&quot;</code><br />
</div>
<p><a href="_variable_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:afba5f4ebc5e8478c5f7a7e354598e698" id="r_afba5f4ebc5e8478c5f7a7e354598e698"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afba5f4ebc5e8478c5f7a7e354598e698">EFI_VARIABLE_APPLE_BIT</a>&#160;&#160;&#160;0x80000000</td></tr>
<tr class="separator:afba5f4ebc5e8478c5f7a7e354598e698"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abc6225f0cb46400f089ab69d625f5d74" id="r_abc6225f0cb46400f089ab69d625f5d74"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abc6225f0cb46400f089ab69d625f5d74">UpdateVariableStore</a> (IN <a class="el" href="struct_v_a_r_i_a_b_l_e___g_l_o_b_a_l.html">VARIABLE_GLOBAL</a> *Global, IN BOOLEAN Volatile, IN BOOLEAN SetByIndex, IN EFI_FIRMWARE_VOLUME_BLOCK_PROTOCOL *Fvb, IN UINTN DataPtrIndex, IN UINT32 DataSize, IN UINT8 *<a class="el" href="_oc_typing_lib_8h.html#a71473576373bdac9b4a2748939f53419">Buffer</a>)</td></tr>
<tr class="separator:abc6225f0cb46400f089ab69d625f5d74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae773c4c2b35599b99d05299312e04bf6" id="r_ae773c4c2b35599b99d05299312e04bf6"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae773c4c2b35599b99d05299312e04bf6">RecordVarErrorFlag</a> (IN VAR_ERROR_FLAG Flag, IN CHAR16 *VariableName, IN EFI_GUID *VendorGuid, IN UINT32 Attributes, IN UINTN VariableSize)</td></tr>
<tr class="separator:ae773c4c2b35599b99d05299312e04bf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58eeb29764118aedd10cb85a080e9cac" id="r_a58eeb29764118aedd10cb85a080e9cac"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a58eeb29764118aedd10cb85a080e9cac">InitializeVarErrorFlag</a> (VOID)</td></tr>
<tr class="separator:a58eeb29764118aedd10cb85a080e9cac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28d86631db866a85d189143da08f819f" id="r_a28d86631db866a85d189143da08f819f"><td class="memItemLeft" align="right" valign="top">BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a28d86631db866a85d189143da08f819f">IsUserVariable</a> (IN VARIABLE_HEADER *Variable)</td></tr>
<tr class="separator:a28d86631db866a85d189143da08f819f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a4c79c0cbc9500241ea96ca9f9803b8" id="r_a3a4c79c0cbc9500241ea96ca9f9803b8"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3a4c79c0cbc9500241ea96ca9f9803b8">CalculateCommonUserVariableTotalSize</a> (VOID)</td></tr>
<tr class="separator:a3a4c79c0cbc9500241ea96ca9f9803b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46448f26a42728fbb81aa3b86c55295e" id="r_a46448f26a42728fbb81aa3b86c55295e"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46448f26a42728fbb81aa3b86c55295e">InitializeVariableQuota</a> (VOID)</td></tr>
<tr class="separator:a46448f26a42728fbb81aa3b86c55295e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b70dce42d0d3ca8e9ddba2d6f93a5dc" id="r_a5b70dce42d0d3ca8e9ddba2d6f93a5dc"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5b70dce42d0d3ca8e9ddba2d6f93a5dc">Reclaim</a> (IN EFI_PHYSICAL_ADDRESS VariableBase, OUT UINTN *LastVariableOffset, IN BOOLEAN IsVolatile, IN OUT <a class="el" href="struct_v_a_r_i_a_b_l_e___p_o_i_n_t_e_r___t_r_a_c_k.html">VARIABLE_POINTER_TRACK</a> *UpdatingPtrTrack, IN VARIABLE_HEADER *NewVariable, IN UINTN NewVariableSize)</td></tr>
<tr class="separator:a5b70dce42d0d3ca8e9ddba2d6f93a5dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2323731f18cc041eb8a0f4a58757865" id="r_aa2323731f18cc041eb8a0f4a58757865"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa2323731f18cc041eb8a0f4a58757865">FindVariable</a> (IN CHAR16 *VariableName, IN EFI_GUID *VendorGuid, OUT <a class="el" href="struct_v_a_r_i_a_b_l_e___p_o_i_n_t_e_r___t_r_a_c_k.html">VARIABLE_POINTER_TRACK</a> *PtrTrack, IN <a class="el" href="struct_v_a_r_i_a_b_l_e___g_l_o_b_a_l.html">VARIABLE_GLOBAL</a> *Global, IN BOOLEAN IgnoreRtCheck)</td></tr>
<tr class="separator:aa2323731f18cc041eb8a0f4a58757865"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4febf5ec4a0ceaca20b3aa271383f076" id="r_a4febf5ec4a0ceaca20b3aa271383f076"><td class="memItemLeft" align="right" valign="top">UINTN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4febf5ec4a0ceaca20b3aa271383f076">GetIndexFromSupportedLangCodes</a> (IN CHAR8 *SupportedLang, IN CHAR8 *Lang, IN BOOLEAN Iso639Language)</td></tr>
<tr class="separator:a4febf5ec4a0ceaca20b3aa271383f076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3f238b7320857c5cab02f419e96010" id="r_a5e3f238b7320857c5cab02f419e96010"><td class="memItemLeft" align="right" valign="top">CHAR8 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5e3f238b7320857c5cab02f419e96010">GetLangFromSupportedLangCodes</a> (IN CHAR8 *SupportedLang, IN UINTN Index, IN BOOLEAN Iso639Language)</td></tr>
<tr class="separator:a5e3f238b7320857c5cab02f419e96010"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1148491e2c86653e41b819634af90952" id="r_a1148491e2c86653e41b819634af90952"><td class="memItemLeft" align="right" valign="top">CHAR8 *EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1148491e2c86653e41b819634af90952">VariableGetBestLanguage</a> (IN CONST CHAR8 *SupportedLanguages, IN UINTN Iso639Language,...)</td></tr>
<tr class="separator:a1148491e2c86653e41b819634af90952"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a643167ed0c18f8195b243bba07acc687" id="r_a643167ed0c18f8195b243bba07acc687"><td class="memItemLeft" align="right" valign="top">BOOLEAN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a643167ed0c18f8195b243bba07acc687">CheckRemainingSpaceForConsistencyInternal</a> (IN UINT32 Attributes, IN VA_LIST Marker)</td></tr>
<tr class="separator:a643167ed0c18f8195b243bba07acc687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0f176bb17485fc6b425e146d9f0be19" id="r_ae0f176bb17485fc6b425e146d9f0be19"><td class="memItemLeft" align="right" valign="top">BOOLEAN EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae0f176bb17485fc6b425e146d9f0be19">CheckRemainingSpaceForConsistency</a> (IN UINT32 Attributes,...)</td></tr>
<tr class="separator:ae0f176bb17485fc6b425e146d9f0be19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abddec7bb15bd91d0f8135944244fd9d9" id="r_abddec7bb15bd91d0f8135944244fd9d9"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abddec7bb15bd91d0f8135944244fd9d9">AutoUpdateLangVariable</a> (IN CHAR16 *VariableName, IN VOID *Data, IN UINTN DataSize)</td></tr>
<tr class="separator:abddec7bb15bd91d0f8135944244fd9d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a02c94ab644da77c25128496e61dd4c" id="r_a3a02c94ab644da77c25128496e61dd4c"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3a02c94ab644da77c25128496e61dd4c">UpdateVariable</a> (IN CHAR16 *VariableName, IN EFI_GUID *VendorGuid, IN VOID *Data, IN UINTN DataSize, IN UINT32 Attributes OPTIONAL, IN UINT32 KeyIndex OPTIONAL, IN UINT64 MonotonicCount OPTIONAL, IN OUT <a class="el" href="struct_v_a_r_i_a_b_l_e___p_o_i_n_t_e_r___t_r_a_c_k.html">VARIABLE_POINTER_TRACK</a> *CacheVariable, IN EFI_TIME *<a class="el" href="_bios_id_8h.html#ad98265f36c1981194bb945c2a61df8e5">TimeStamp</a> OPTIONAL)</td></tr>
<tr class="separator:a3a02c94ab644da77c25128496e61dd4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38241635709c8a9783ac662395625630" id="r_a38241635709c8a9783ac662395625630"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a38241635709c8a9783ac662395625630">VariableServiceGetVariable</a> (IN CHAR16 *VariableName, IN EFI_GUID *VendorGuid, OUT UINT32 *Attributes OPTIONAL, IN OUT UINTN *DataSize, OUT VOID *Data OPTIONAL)</td></tr>
<tr class="separator:a38241635709c8a9783ac662395625630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99dbf5266c658a48cc220e3c4ebd1c75" id="r_a99dbf5266c658a48cc220e3c4ebd1c75"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a99dbf5266c658a48cc220e3c4ebd1c75">VariableServiceGetNextVariableName</a> (IN OUT UINTN *VariableNameSize, IN OUT CHAR16 *VariableName, IN OUT EFI_GUID *VendorGuid)</td></tr>
<tr class="separator:a99dbf5266c658a48cc220e3c4ebd1c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3f89de9a5b91a5f2f5c360531717235" id="r_ae3f89de9a5b91a5f2f5c360531717235"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae3f89de9a5b91a5f2f5c360531717235">VariableServiceSetVariable</a> (IN CHAR16 *VariableName, IN EFI_GUID *VendorGuid, IN UINT32 Attributes, IN UINTN DataSize, IN VOID *Data)</td></tr>
<tr class="separator:ae3f89de9a5b91a5f2f5c360531717235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3a7d9c60d30f1400b9e1c678c80ce72" id="r_ad3a7d9c60d30f1400b9e1c678c80ce72"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad3a7d9c60d30f1400b9e1c678c80ce72">VariableServiceQueryVariableInfoInternal</a> (IN UINT32 Attributes, OUT UINT64 *MaximumVariableStorageSize, OUT UINT64 *RemainingVariableStorageSize, OUT UINT64 *MaximumVariableSize)</td></tr>
<tr class="separator:ad3a7d9c60d30f1400b9e1c678c80ce72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab050b35b82d47c13e49489a22a01aa02" id="r_ab050b35b82d47c13e49489a22a01aa02"><td class="memItemLeft" align="right" valign="top">EFI_STATUS EFIAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab050b35b82d47c13e49489a22a01aa02">VariableServiceQueryVariableInfo</a> (IN UINT32 Attributes, OUT UINT64 *MaximumVariableStorageSize, OUT UINT64 *RemainingVariableStorageSize, OUT UINT64 *MaximumVariableSize)</td></tr>
<tr class="separator:ab050b35b82d47c13e49489a22a01aa02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80167a36140c0a7042668a3eb084765d" id="r_a80167a36140c0a7042668a3eb084765d"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80167a36140c0a7042668a3eb084765d">ReclaimForOS</a> (VOID)</td></tr>
<tr class="separator:a80167a36140c0a7042668a3eb084765d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37de26ddcf6da8224e21da5a22554dfb" id="r_a37de26ddcf6da8224e21da5a22554dfb"><td class="memItemLeft" align="right" valign="top">UINTN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a37de26ddcf6da8224e21da5a22554dfb">GetMaxVariableSize</a> (VOID)</td></tr>
<tr class="separator:a37de26ddcf6da8224e21da5a22554dfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace4b6929ba04f740993571616a109f52" id="r_ace4b6929ba04f740993571616a109f52"><td class="memItemLeft" align="right" valign="top">VOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ace4b6929ba04f740993571616a109f52">FlushHobVariableToFlash</a> (IN CHAR16 *VariableName, IN EFI_GUID *VendorGuid)</td></tr>
<tr class="separator:ace4b6929ba04f740993571616a109f52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d47dd506907d025366155d1c2fa4fcc" id="r_a6d47dd506907d025366155d1c2fa4fcc"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6d47dd506907d025366155d1c2fa4fcc">VariableWriteServiceInitialize</a> (VOID)</td></tr>
<tr class="separator:a6d47dd506907d025366155d1c2fa4fcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f0f94d7935461b9364cadb6d088bdc5" id="r_a5f0f94d7935461b9364cadb6d088bdc5"><td class="memItemLeft" align="right" valign="top">VOID *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5f0f94d7935461b9364cadb6d088bdc5">ConvertNormalVarStorageToAuthVarStorage</a> (VARIABLE_STORE_HEADER *NormalVarStorage)</td></tr>
<tr class="separator:a5f0f94d7935461b9364cadb6d088bdc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6370e83ebfcc9ce1841c8dc67baa3521" id="r_a6370e83ebfcc9ce1841c8dc67baa3521"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6370e83ebfcc9ce1841c8dc67baa3521">GetHobVariableStore</a> (IN EFI_GUID *VariableGuid)</td></tr>
<tr class="separator:a6370e83ebfcc9ce1841c8dc67baa3521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85bedf12b2d1dcd2260e9a8997e74e36" id="r_a85bedf12b2d1dcd2260e9a8997e74e36"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85bedf12b2d1dcd2260e9a8997e74e36">VariableCommonInitialize</a> (VOID)</td></tr>
<tr class="separator:a85bedf12b2d1dcd2260e9a8997e74e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf15b9520c53807fe00b79675ff386c8" id="r_abf15b9520c53807fe00b79675ff386c8"><td class="memItemLeft" align="right" valign="top">EFI_STATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abf15b9520c53807fe00b79675ff386c8">GetFvbInfoByAddress</a> (IN EFI_PHYSICAL_ADDRESS Address, OUT EFI_HANDLE *FvbHandle OPTIONAL, OUT EFI_FIRMWARE_VOLUME_BLOCK_PROTOCOL **FvbProtocol OPTIONAL)</td></tr>
<tr class="separator:abf15b9520c53807fe00b79675ff386c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:adc82f6c4da89c6c394296c7603f26509" id="r_adc82f6c4da89c6c394296c7603f26509"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_v_a_r_i_a_b_l_e___m_o_d_u_l_e___g_l_o_b_a_l.html">VARIABLE_MODULE_GLOBAL</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc82f6c4da89c6c394296c7603f26509">mVariableModuleGlobal</a></td></tr>
<tr class="separator:adc82f6c4da89c6c394296c7603f26509"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a644cd901e32eee1a899fefc2cca562c2" id="r_a644cd901e32eee1a899fefc2cca562c2"><td class="memItemLeft" align="right" valign="top">VARIABLE_STORE_HEADER *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a644cd901e32eee1a899fefc2cca562c2">mNvVariableCache</a> = NULL</td></tr>
<tr class="separator:a644cd901e32eee1a899fefc2cca562c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a027219dab86d5521639b81968485f44b" id="r_a027219dab86d5521639b81968485f44b"><td class="memItemLeft" align="right" valign="top">EFI_FIRMWARE_VOLUME_HEADER *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a027219dab86d5521639b81968485f44b">mNvFvHeaderCache</a> = NULL</td></tr>
<tr class="separator:a027219dab86d5521639b81968485f44b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a239c0c1136664713bf6fed1d6ed6a0b5" id="r_a239c0c1136664713bf6fed1d6ed6a0b5"><td class="memItemLeft" align="right" valign="top">VARIABLE_INFO_ENTRY *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a239c0c1136664713bf6fed1d6ed6a0b5">gVariableInfo</a> = NULL</td></tr>
<tr class="separator:a239c0c1136664713bf6fed1d6ed6a0b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c81c84647eda976ac0e130c7126b970" id="r_a0c81c84647eda976ac0e130c7126b970"><td class="memItemLeft" align="right" valign="top">BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c81c84647eda976ac0e130c7126b970">mEndOfDxe</a> = FALSE</td></tr>
<tr class="separator:a0c81c84647eda976ac0e130c7126b970"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8f67c980ff7857b099f1d27df4a40d6" id="r_aa8f67c980ff7857b099f1d27df4a40d6"><td class="memItemLeft" align="right" valign="top">VAR_CHECK_REQUEST_SOURCE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa8f67c980ff7857b099f1d27df4a40d6">mRequestSource</a> = VarCheckFromUntrusted</td></tr>
<tr class="separator:aa8f67c980ff7857b099f1d27df4a40d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f9f67f9ac4302e30e0e03bdce06034b" id="r_a4f9f67f9ac4302e30e0e03bdce06034b"><td class="memItemLeft" align="right" valign="top">VAR_ERROR_FLAG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f9f67f9ac4302e30e0e03bdce06034b">mCurrentBootVarErrFlag</a> = VAR_ERROR_FLAG_NO_ERROR</td></tr>
<tr class="separator:a4f9f67f9ac4302e30e0e03bdce06034b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaebbf98a4d969c243f865bb03acb898" id="r_abaebbf98a4d969c243f865bb03acb898"><td class="memItemLeft" align="right" valign="top">VARIABLE_ENTRY_PROPERTY&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abaebbf98a4d969c243f865bb03acb898">mVariableEntryProperty</a> []</td></tr>
<tr class="separator:abaebbf98a4d969c243f865bb03acb898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31ffcc7e4a1c4380de4365472ad5659b" id="r_a31ffcc7e4a1c4380de4365472ad5659b"><td class="memItemLeft" align="right" valign="top">AUTH_VAR_LIB_CONTEXT_IN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a31ffcc7e4a1c4380de4365472ad5659b">mAuthContextIn</a></td></tr>
<tr class="separator:a31ffcc7e4a1c4380de4365472ad5659b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41e5334885fd8dbf42c51a10545ee63f" id="r_a41e5334885fd8dbf42c51a10545ee63f"><td class="memItemLeft" align="right" valign="top">AUTH_VAR_LIB_CONTEXT_OUT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41e5334885fd8dbf42c51a10545ee63f">mAuthContextOut</a></td></tr>
<tr class="separator:a41e5334885fd8dbf42c51a10545ee63f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The common variable operation routines shared by DXE_RUNTIME variable module and DXE_SMM variable module.</p>
<p>Caution: This module requires additional review when modified. This driver will have external input - variable data. They may be input in SMM mode. This external input must be validated carefully to avoid security issue like buffer overflow, integer overflow.</p>
<p>VariableServiceGetNextVariableName () and <a class="el" href="#ab050b35b82d47c13e49489a22a01aa02">VariableServiceQueryVariableInfo()</a> are external API. They need check input parameter.</p>
<p><a class="el" href="#a38241635709c8a9783ac662395625630">VariableServiceGetVariable()</a> and <a class="el" href="#ae3f89de9a5b91a5f2f5c360531717235">VariableServiceSetVariable()</a> are external API to receive datasize and data buffer. The size should be checked carefully.</p>
<p><a class="el" href="#ae3f89de9a5b91a5f2f5c360531717235">VariableServiceSetVariable()</a> should also check authenticate data to avoid buffer overflow, integer overflow. It should also check attribute to avoid authentication bypass.</p>
<p>Copyright (c) 2006 - 2020, Intel Corporation. All rights reserved.<br  />
 (C) Copyright 2015-2018 Hewlett Packard Enterprise Development LP<br  />
 Copyright (c) Microsoft Corporation.<br  />
 Copyright (c) 2022, ARM Limited. All rights reserved.<br  />
</p>
<p>SPDX-License-Identifier: BSD-2-Clause-Patent </p>

<p class="definition">Definition in file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="afba5f4ebc5e8478c5f7a7e354598e698" name="afba5f4ebc5e8478c5f7a7e354598e698"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afba5f4ebc5e8478c5f7a7e354598e698">&#9670;&#160;</a></span>EFI_VARIABLE_APPLE_BIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EFI_VARIABLE_APPLE_BIT&#160;&#160;&#160;0x80000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00033">33</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="abddec7bb15bd91d0f8135944244fd9d9" name="abddec7bb15bd91d0f8135944244fd9d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abddec7bb15bd91d0f8135944244fd9d9">&#9670;&#160;</a></span>AutoUpdateLangVariable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS AutoUpdateLangVariable </td>
          <td>(</td>
          <td class="paramtype">IN CHAR16 *</td>          <td class="paramname"><span class="paramname"><em>VariableName</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VOID *</td>          <td class="paramname"><span class="paramname"><em>Data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>DataSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Hook the operations in PlatformLangCodes, LangCodes, PlatformLang and Lang.</p>
<p>When setting Lang/LangCodes, simultaneously update PlatformLang/PlatformLangCodes.</p>
<p>According to UEFI spec, PlatformLangCodes/LangCodes are only set once in firmware initialization, and are read-only. Therefore, in variable driver, only store the original value for other use.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableName</td><td>Name of variable.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Data</td><td>Variable data.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataSize</td><td>Size of data. 0 means delete.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The update operation is successful or ignored. </td></tr>
    <tr><td class="paramname">EFI_WRITE_PROTECTED</td><td>Update PlatformLangCodes/LangCodes at runtime. </td></tr>
    <tr><td class="paramname">EFI_OUT_OF_RESOURCES</td><td>No enough variable space to do the update operation. </td></tr>
    <tr><td class="paramname">Others</td><td>Other errors happened during the update operation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l01417">1417</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a3a4c79c0cbc9500241ea96ca9f9803b8" name="a3a4c79c0cbc9500241ea96ca9f9803b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a4c79c0cbc9500241ea96ca9f9803b8">&#9670;&#160;</a></span>CalculateCommonUserVariableTotalSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID CalculateCommonUserVariableTotalSize </td>
          <td>(</td>
          <td class="paramtype">VOID</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate common user variable total size. </p>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00447">447</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="ae0f176bb17485fc6b425e146d9f0be19" name="ae0f176bb17485fc6b425e146d9f0be19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0f176bb17485fc6b425e146d9f0be19">&#9670;&#160;</a></span>CheckRemainingSpaceForConsistency()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOLEAN EFIAPI CheckRemainingSpaceForConsistency </td>
          <td>(</td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>Attributes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>...</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is to check if the remaining variable space is enough to set all Variables from argument list successfully. The purpose of the check is to keep the consistency of the Variables to be in variable storage.</p>
<p>Note: Variables are assumed to be in same storage. The set sequence of Variables will be same with the sequence of VariableEntry from argument list, so follow the argument sequence to check the Variables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Attributes</td><td>Variable attributes for Variable entries. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">...</td><td>The variable argument list with type VARIABLE_ENTRY_CONSISTENCY *. A NULL terminates the list. The VariableSize of VARIABLE_ENTRY_CONSISTENCY is the variable data size as input. It will be changed to variable total size as output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>Have enough variable space to set the Variables successfully. </td></tr>
    <tr><td class="paramname">FALSE</td><td>No enough variable space to set the Variables successfully. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l01379">1379</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a643167ed0c18f8195b243bba07acc687" name="a643167ed0c18f8195b243bba07acc687"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a643167ed0c18f8195b243bba07acc687">&#9670;&#160;</a></span>CheckRemainingSpaceForConsistencyInternal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOLEAN EFIAPI CheckRemainingSpaceForConsistencyInternal </td>
          <td>(</td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>Attributes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VA_LIST</td>          <td class="paramname"><span class="paramname"><em>Marker</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function is to check if the remaining variable space is enough to set all Variables from argument list successfully. The purpose of the check is to keep the consistency of the Variables to be in variable storage.</p>
<p>Note: Variables are assumed to be in same storage. The set sequence of Variables will be same with the sequence of VariableEntry from argument list, so follow the argument sequence to check the Variables.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Attributes</td><td>Variable attributes for Variable entries. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Marker</td><td>VA_LIST style variable argument list. The variable argument list with type VARIABLE_ENTRY_CONSISTENCY *. A NULL terminates the list. The VariableSize of VARIABLE_ENTRY_CONSISTENCY is the variable data size as input. It will be changed to variable total size as output.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>Have enough variable space to set the Variables successfully. </td></tr>
    <tr><td class="paramname">FALSE</td><td>No enough variable space to set the Variables successfully. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l01242">1242</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a5f0f94d7935461b9364cadb6d088bdc5" name="a5f0f94d7935461b9364cadb6d088bdc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f0f94d7935461b9364cadb6d088bdc5">&#9670;&#160;</a></span>ConvertNormalVarStorageToAuthVarStorage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID * ConvertNormalVarStorageToAuthVarStorage </td>
          <td>(</td>
          <td class="paramtype">VARIABLE_STORE_HEADER *</td>          <td class="paramname"><span class="paramname"><em>NormalVarStorage</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert normal variable storage to the allocated auth variable storage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">NormalVarStorage</td><td>Pointer to the normal variable storage header</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">the</td><td>allocated auth variable storage </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l03523">3523</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="aa2323731f18cc041eb8a0f4a58757865" name="aa2323731f18cc041eb8a0f4a58757865"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2323731f18cc041eb8a0f4a58757865">&#9670;&#160;</a></span>FindVariable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS FindVariable </td>
          <td>(</td>
          <td class="paramtype">IN CHAR16 *</td>          <td class="paramname"><span class="paramname"><em>VariableName</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_GUID *</td>          <td class="paramname"><span class="paramname"><em>VendorGuid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT <a class="el" href="struct_v_a_r_i_a_b_l_e___p_o_i_n_t_e_r___t_r_a_c_k.html">VARIABLE_POINTER_TRACK</a> *</td>          <td class="paramname"><span class="paramname"><em>PtrTrack</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN <a class="el" href="struct_v_a_r_i_a_b_l_e___g_l_o_b_a_l.html">VARIABLE_GLOBAL</a> *</td>          <td class="paramname"><span class="paramname"><em>Global</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN</td>          <td class="paramname"><span class="paramname"><em>IgnoreRtCheck</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finds variable in storage blocks of volatile and non-volatile storage areas.</p>
<p>This code finds variable in storage blocks of volatile and non-volatile storage areas. If VariableName is an empty string, then we just return the first qualified variable without comparing VariableName and VendorGuid. If IgnoreRtCheck is TRUE, then we ignore the EFI_VARIABLE_RUNTIME_ACCESS attribute check at runtime when searching existing variable, only VariableName and VendorGuid are compared. Otherwise, variables without EFI_VARIABLE_RUNTIME_ACCESS are not visible at runtime.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableName</td><td>Name of the variable to be found. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VendorGuid</td><td>Vendor GUID to be found. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">PtrTrack</td><td><a class="el" href="struct_v_a_r_i_a_b_l_e___p_o_i_n_t_e_r___t_r_a_c_k.html">VARIABLE_POINTER_TRACK</a> structure for output, including the range searched and the target position. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Global</td><td>Pointer to <a class="el" href="struct_v_a_r_i_a_b_l_e___g_l_o_b_a_l.html">VARIABLE_GLOBAL</a> structure, including base of volatile variable storage area, base of NV variable storage area, and a lock. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IgnoreRtCheck</td><td>Ignore EFI_VARIABLE_RUNTIME_ACCESS attribute check at runtime when searching variable.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>If VariableName is not an empty string, while VendorGuid is NULL. </td></tr>
    <tr><td class="paramname">EFI_SUCCESS</td><td>Variable successfully found. </td></tr>
    <tr><td class="paramname">EFI_NOT_FOUND</td><td>Variable not found </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00853">853</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="ace4b6929ba04f740993571616a109f52" name="ace4b6929ba04f740993571616a109f52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace4b6929ba04f740993571616a109f52">&#9670;&#160;</a></span>FlushHobVariableToFlash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID FlushHobVariableToFlash </td>
          <td>(</td>
          <td class="paramtype">IN CHAR16 *</td>          <td class="paramname"><span class="paramname"><em>VariableName</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_GUID *</td>          <td class="paramname"><span class="paramname"><em>VendorGuid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Flush the HOB variable to flash.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableName</td><td>Name of variable has been updated or deleted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VendorGuid</td><td>Guid of variable has been updated or deleted. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l03294">3294</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="abf15b9520c53807fe00b79675ff386c8" name="abf15b9520c53807fe00b79675ff386c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf15b9520c53807fe00b79675ff386c8">&#9670;&#160;</a></span>GetFvbInfoByAddress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS GetFvbInfoByAddress </td>
          <td>(</td>
          <td class="paramtype">IN EFI_PHYSICAL_ADDRESS</td>          <td class="paramname"><span class="paramname"><em>Address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT EFI_HANDLE *FvbHandle</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT EFI_FIRMWARE_VOLUME_BLOCK_PROTOCOL **FvbProtocol</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the proper fvb handle and/or fvb protocol by the given Flash address.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Address</td><td>The Flash address. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">FvbHandle</td><td>In output, if it is not NULL, it points to the proper FVB handle. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">FvbProtocol</td><td>In output, if it is not NULL, it points to the proper FVB protocol. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l03822">3822</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a6370e83ebfcc9ce1841c8dc67baa3521" name="a6370e83ebfcc9ce1841c8dc67baa3521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6370e83ebfcc9ce1841c8dc67baa3521">&#9670;&#160;</a></span>GetHobVariableStore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS GetHobVariableStore </td>
          <td>(</td>
          <td class="paramtype">IN EFI_GUID *</td>          <td class="paramname"><span class="paramname"><em>VariableGuid</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get HOB variable store.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableGuid</td><td>NV variable store signature.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>Function successfully executed. </td></tr>
    <tr><td class="paramname">EFI_OUT_OF_RESOURCES</td><td>Fail to allocate enough memory resource. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l03632">3632</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a4febf5ec4a0ceaca20b3aa271383f076" name="a4febf5ec4a0ceaca20b3aa271383f076"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4febf5ec4a0ceaca20b3aa271383f076">&#9670;&#160;</a></span>GetIndexFromSupportedLangCodes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINTN GetIndexFromSupportedLangCodes </td>
          <td>(</td>
          <td class="paramtype">IN CHAR8 *</td>          <td class="paramname"><span class="paramname"><em>SupportedLang</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CHAR8 *</td>          <td class="paramname"><span class="paramname"><em>Lang</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN</td>          <td class="paramname"><span class="paramname"><em>Iso639Language</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get index from supported language codes according to language string.</p>
<p>This code is used to get corresponding index in supported language codes. It can handle RFC4646 and ISO639 language tags. In ISO639 language tags, take 3-characters as a delimitation to find matched string and calculate the index. In RFC4646 language tags, take semicolon as a delimitation to find matched string and calculate the index.</p>
<p>For example: SupportedLang = "engfraengfra" Lang = "eng" Iso639Language = TRUE The return value is "0". Another example: SupportedLang = "en;fr;en-US;fr-FR" Lang = "fr-FR" Iso639Language = FALSE The return value is "3".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SupportedLang</td><td>Platform supported language codes. </td></tr>
    <tr><td class="paramname">Lang</td><td>Configured language. </td></tr>
    <tr><td class="paramname">Iso639Language</td><td>A bool value to signify if the handler is operated on ISO639 or RFC4646.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>index of language in the language codes. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00932">932</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a5e3f238b7320857c5cab02f419e96010" name="a5e3f238b7320857c5cab02f419e96010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e3f238b7320857c5cab02f419e96010">&#9670;&#160;</a></span>GetLangFromSupportedLangCodes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CHAR8 * GetLangFromSupportedLangCodes </td>
          <td>(</td>
          <td class="paramtype">IN CHAR8 *</td>          <td class="paramname"><span class="paramname"><em>SupportedLang</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>Index</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN</td>          <td class="paramname"><span class="paramname"><em>Iso639Language</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get language string from supported language codes according to index.</p>
<p>This code is used to get corresponding language strings in supported language codes. It can handle RFC4646 and ISO639 language tags. In ISO639 language tags, take 3-characters as a delimitation. Find language string according to the index. In RFC4646 language tags, take semicolon as a delimitation. Find language string according to the index.</p>
<p>For example: SupportedLang = "engfraengfra" Index = "1" Iso639Language = TRUE The return value is "fra". Another example: SupportedLang = "en;fr;en-US;fr-FR" Index = "1" Iso639Language = FALSE The return value is "fr".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SupportedLang</td><td>Platform supported language codes. </td></tr>
    <tr><td class="paramname">Index</td><td>The index in supported language codes. </td></tr>
    <tr><td class="paramname">Iso639Language</td><td>A bool value to signify if the handler is operated on ISO639 or RFC4646.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">The</td><td>language string in the language codes. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l01019">1019</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a37de26ddcf6da8224e21da5a22554dfb" name="a37de26ddcf6da8224e21da5a22554dfb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37de26ddcf6da8224e21da5a22554dfb">&#9670;&#160;</a></span>GetMaxVariableSize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">UINTN GetMaxVariableSize </td>
          <td>(</td>
          <td class="paramtype">VOID</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get maximum variable size, covering both non-volatile and volatile variables.</p>
<dl class="section return"><dt>Returns</dt><dd>Maximum variable size. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l03268">3268</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a58eeb29764118aedd10cb85a080e9cac" name="a58eeb29764118aedd10cb85a080e9cac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58eeb29764118aedd10cb85a080e9cac">&#9670;&#160;</a></span>InitializeVarErrorFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID InitializeVarErrorFlag </td>
          <td>(</td>
          <td class="paramtype">VOID</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize variable error flag.</p>
<p>Before EndOfDxe, the variable indicates the last boot variable error flag, then it means the last boot variable error flag must be got before EndOfDxe. After EndOfDxe, the variable indicates the current boot variable error flag, then it means the current boot variable error flag must be got after EndOfDxe. </p>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00364">364</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a46448f26a42728fbb81aa3b86c55295e" name="a46448f26a42728fbb81aa3b86c55295e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46448f26a42728fbb81aa3b86c55295e">&#9670;&#160;</a></span>InitializeVariableQuota()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID InitializeVariableQuota </td>
          <td>(</td>
          <td class="paramtype">VOID</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize variable quota. </p>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00490">490</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a28d86631db866a85d189143da08f819f" name="a28d86631db866a85d189143da08f819f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28d86631db866a85d189143da08f819f">&#9670;&#160;</a></span>IsUserVariable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOLEAN IsUserVariable </td>
          <td>(</td>
          <td class="paramtype">IN VARIABLE_HEADER *</td>          <td class="paramname"><span class="paramname"><em>Variable</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Is user variable?</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Variable</td><td>Pointer to variable header.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>User variable. </td></tr>
    <tr><td class="paramname">FALSE</td><td>System variable. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00417">417</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a5b70dce42d0d3ca8e9ddba2d6f93a5dc" name="a5b70dce42d0d3ca8e9ddba2d6f93a5dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b70dce42d0d3ca8e9ddba2d6f93a5dc">&#9670;&#160;</a></span>Reclaim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS Reclaim </td>
          <td>(</td>
          <td class="paramtype">IN EFI_PHYSICAL_ADDRESS</td>          <td class="paramname"><span class="paramname"><em>VariableBase</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINTN *</td>          <td class="paramname"><span class="paramname"><em>LastVariableOffset</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN</td>          <td class="paramname"><span class="paramname"><em>IsVolatile</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT <a class="el" href="struct_v_a_r_i_a_b_l_e___p_o_i_n_t_e_r___t_r_a_c_k.html">VARIABLE_POINTER_TRACK</a> *</td>          <td class="paramname"><span class="paramname"><em>UpdatingPtrTrack</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VARIABLE_HEADER *</td>          <td class="paramname"><span class="paramname"><em>NewVariable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>NewVariableSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Variable store garbage collection and reclaim operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableBase</td><td>Base address of variable store. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">LastVariableOffset</td><td>Offset of last variable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">IsVolatile</td><td>The variable store is volatile or not; if it is non-volatile, need FTW. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">UpdatingPtrTrack</td><td>Pointer to updating variable pointer track structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NewVariable</td><td>Pointer to new variable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NewVariableSize</td><td>New variable size.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>EFI_SUCCESS Reclaim operation has finished successfully. </dd>
<dd>
EFI_OUT_OF_RESOURCES No enough memory resources or variable space. </dd>
<dd>
Others Unexpect error happened during reclaim operation. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00520">520</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a80167a36140c0a7042668a3eb084765d" name="a80167a36140c0a7042668a3eb084765d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80167a36140c0a7042668a3eb084765d">&#9670;&#160;</a></span>ReclaimForOS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID ReclaimForOS </td>
          <td>(</td>
          <td class="paramtype">VOID</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function reclaims variable storage if free size is below the threshold.</p>
<p>Caution: This function may be invoked at SMM mode. Care must be taken to make sure not security issue. </p>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l03213">3213</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="ae773c4c2b35599b99d05299312e04bf6" name="ae773c4c2b35599b99d05299312e04bf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae773c4c2b35599b99d05299312e04bf6">&#9670;&#160;</a></span>RecordVarErrorFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VOID RecordVarErrorFlag </td>
          <td>(</td>
          <td class="paramtype">IN VAR_ERROR_FLAG</td>          <td class="paramname"><span class="paramname"><em>Flag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN CHAR16 *</td>          <td class="paramname"><span class="paramname"><em>VariableName</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_GUID *</td>          <td class="paramname"><span class="paramname"><em>VendorGuid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>Attributes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>VariableSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Record variable error flag.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Flag</td><td>Variable error flag to record. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableName</td><td>Name of variable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VendorGuid</td><td>Guid of variable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Attributes</td><td>Attributes of the variable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableSize</td><td>Size of the variable. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00274">274</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a3a02c94ab644da77c25128496e61dd4c" name="a3a02c94ab644da77c25128496e61dd4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a02c94ab644da77c25128496e61dd4c">&#9670;&#160;</a></span>UpdateVariable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS UpdateVariable </td>
          <td>(</td>
          <td class="paramtype">IN CHAR16 *</td>          <td class="paramname"><span class="paramname"><em>VariableName</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_GUID *</td>          <td class="paramname"><span class="paramname"><em>VendorGuid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VOID *</td>          <td class="paramname"><span class="paramname"><em>Data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>DataSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32 Attributes</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32 KeyIndex</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT64 MonotonicCount</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT <a class="el" href="struct_v_a_r_i_a_b_l_e___p_o_i_n_t_e_r___t_r_a_c_k.html">VARIABLE_POINTER_TRACK</a> *</td>          <td class="paramname"><span class="paramname"><em>CacheVariable</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_TIME *<a class="el" href="_bios_id_8h.html#ad98265f36c1981194bb945c2a61df8e5">TimeStamp</a></td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Update the variable region with Variable information. If EFI_VARIABLE_AUTHENTICATED_WRITE_ACCESS is set, index of associated public key is needed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">VariableName</td><td>Name of variable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VendorGuid</td><td>Guid of variable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Data</td><td>Variable data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataSize</td><td>Size of data. 0 means delete. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Attributes</td><td>Attributes of the variable. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">KeyIndex</td><td>Index of associated public key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MonotonicCount</td><td>Value of associated monotonic count. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">CacheVariable</td><td>The variable information which is used to keep track of variable usage. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TimeStamp</td><td>Value of associated TimeStamp.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The update operation is success. </td></tr>
    <tr><td class="paramname">EFI_OUT_OF_RESOURCES</td><td>Variable region is full, can not write other data into this region. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l01680">1680</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="abc6225f0cb46400f089ab69d625f5d74" name="abc6225f0cb46400f089ab69d625f5d74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc6225f0cb46400f089ab69d625f5d74">&#9670;&#160;</a></span>UpdateVariableStore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS UpdateVariableStore </td>
          <td>(</td>
          <td class="paramtype">IN <a class="el" href="struct_v_a_r_i_a_b_l_e___g_l_o_b_a_l.html">VARIABLE_GLOBAL</a> *</td>          <td class="paramname"><span class="paramname"><em>Global</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN</td>          <td class="paramname"><span class="paramname"><em>Volatile</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN BOOLEAN</td>          <td class="paramname"><span class="paramname"><em>SetByIndex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_FIRMWARE_VOLUME_BLOCK_PROTOCOL *</td>          <td class="paramname"><span class="paramname"><em>Fvb</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>DataPtrIndex</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>DataSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT8 *</td>          <td class="paramname"><span class="paramname"><em>Buffer</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function writes data to the FWH at the correct LBA even if the LBAs are fragmented.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Global</td><td>Pointer to VARAIBLE_GLOBAL structure. </td></tr>
    <tr><td class="paramname">Volatile</td><td>Point out the Variable is Volatile or Non-Volatile. </td></tr>
    <tr><td class="paramname">SetByIndex</td><td>TRUE if target pointer is given as index. FALSE if target pointer is absolute. </td></tr>
    <tr><td class="paramname">Fvb</td><td>Pointer to the writable FVB protocol. </td></tr>
    <tr><td class="paramname">DataPtrIndex</td><td>Pointer to the Data from the end of VARIABLE_STORE_HEADER structure. </td></tr>
    <tr><td class="paramname">DataSize</td><td>Size of data to be written. </td></tr>
    <tr><td class="paramname">Buffer</td><td>Pointer to the buffer from which data is written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>Parameters not valid. </td></tr>
    <tr><td class="paramname">EFI_UNSUPPORTED</td><td>Fvb is a NULL for Non-Volatile variable update. </td></tr>
    <tr><td class="paramname">EFI_OUT_OF_RESOURCES</td><td>The remaining size is not enough. </td></tr>
    <tr><td class="paramname">EFI_SUCCESS</td><td>Variable store successfully updated. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00125">125</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a85bedf12b2d1dcd2260e9a8997e74e36" name="a85bedf12b2d1dcd2260e9a8997e74e36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85bedf12b2d1dcd2260e9a8997e74e36">&#9670;&#160;</a></span>VariableCommonInitialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS VariableCommonInitialize </td>
          <td>(</td>
          <td class="paramtype">VOID</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes variable store area for non-volatile and volatile variable.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>Function successfully executed. </td></tr>
    <tr><td class="paramname">EFI_OUT_OF_RESOURCES</td><td>Fail to allocate enough memory resource. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l03714">3714</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a1148491e2c86653e41b819634af90952" name="a1148491e2c86653e41b819634af90952"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1148491e2c86653e41b819634af90952">&#9670;&#160;</a></span>VariableGetBestLanguage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CHAR8 *EFIAPI VariableGetBestLanguage </td>
          <td>(</td>
          <td class="paramtype">IN CONST CHAR8 *</td>          <td class="paramname"><span class="paramname"><em>SupportedLanguages</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>Iso639Language</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>...</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns a pointer to an allocated buffer that contains the best matching language from a set of supported languages.</p>
<p>This function supports both ISO 639-2 and RFC 4646 language codes, but language code types may not be mixed in a single call to this function. This function supports a variable argument list that allows the caller to pass in a prioritized list of language codes to test against all the language codes in SupportedLanguages.</p>
<p>If SupportedLanguages is NULL, then <a class="el" href="coder_8h.html#aca68c0d4ac8df0838e209fb5300f7be3">ASSERT()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">SupportedLanguages</td><td>A pointer to a Null-terminated ASCII string that contains a set of language codes in the format specified by Iso639Language. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Iso639Language</td><td>If not zero, then all language codes are assumed to be in ISO 639-2 format. If zero, then all language codes are assumed to be in RFC 4646 language format </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">...</td><td>A variable argument list that contains pointers to Null-terminated ASCII strings that contain one or more language codes in the format specified by Iso639Language. The first language code from each of these language code lists is used to determine if it is an exact or close match to any of the language codes in SupportedLanguages. Close matches only apply to RFC 4646 language codes, and the matching algorithm from RFC 4647 is used to determine if a close match is present. If an exact or close match is found, then the matching language code from SupportedLanguages is returned. If no matches are found, then the next variable argument parameter is evaluated. The variable argument list is terminated by a NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>The best matching language could not be found in SupportedLanguages. </td></tr>
    <tr><td class="paramname">NULL</td><td>There are not enough resources available to return the best matching language. </td></tr>
    <tr><td class="paramname">Other</td><td>A pointer to a Null-terminated ASCII string that is the best matching language in SupportedLanguages. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l01120">1120</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a99dbf5266c658a48cc220e3c4ebd1c75" name="a99dbf5266c658a48cc220e3c4ebd1c75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99dbf5266c658a48cc220e3c4ebd1c75">&#9670;&#160;</a></span>VariableServiceGetNextVariableName()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI VariableServiceGetNextVariableName </td>
          <td>(</td>
          <td class="paramtype">IN OUT UINTN *</td>          <td class="paramname"><span class="paramname"><em>VariableNameSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT CHAR16 *</td>          <td class="paramname"><span class="paramname"><em>VariableName</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT EFI_GUID *</td>          <td class="paramname"><span class="paramname"><em>VendorGuid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This code Finds the Next available variable.</p>
<p>Caution: This function may receive untrusted input. This function may be invoked in SMM mode. This function will do basic validation, before parse the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VariableNameSize</td><td>The size of the VariableName buffer. The size must be large enough to fit input string supplied in VariableName buffer. </td></tr>
    <tr><td class="paramname">VariableName</td><td>Pointer to variable name. </td></tr>
    <tr><td class="paramname">VendorGuid</td><td>Variable Vendor Guid.</td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>The function completed successfully. </td></tr>
    <tr><td class="paramname">EFI_NOT_FOUND</td><td>The next variable was not found. </td></tr>
    <tr><td class="paramname">EFI_BUFFER_TOO_SMALL</td><td>The VariableNameSize is too small for the result. VariableNameSize has been updated with the size needed to complete the request. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>VariableNameSize is NULL. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>VariableName is NULL. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>VendorGuid is NULL. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>The input values of VariableName and VendorGuid are not a name and GUID of an existing variable. </td></tr>
    <tr><td class="paramname">EFI_INVALID_PARAMETER</td><td>Null-terminator is not found in the first VariableNameSize bytes of the input VariableName buffer. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l02525">2525</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a38241635709c8a9783ac662395625630" name="a38241635709c8a9783ac662395625630"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38241635709c8a9783ac662395625630">&#9670;&#160;</a></span>VariableServiceGetVariable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI VariableServiceGetVariable </td>
          <td>(</td>
          <td class="paramtype">IN CHAR16 *</td>          <td class="paramname"><span class="paramname"><em>VariableName</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_GUID *</td>          <td class="paramname"><span class="paramname"><em>VendorGuid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT32 *Attributes</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN OUT UINTN *</td>          <td class="paramname"><span class="paramname"><em>DataSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT VOID *Data</td>          <td class="paramname"><span class="paramname"><em>OPTIONAL</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This code finds variable in storage blocks (Volatile or Non-Volatile).</p>
<p>Caution: This function may receive untrusted input. This function may be invoked in SMM mode, and datasize is external input. This function will do basic validation, before parse the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VariableName</td><td>Name of Variable to be found. </td></tr>
    <tr><td class="paramname">VendorGuid</td><td>Variable vendor GUID. </td></tr>
    <tr><td class="paramname">Attributes</td><td>Attribute value of the variable found. </td></tr>
    <tr><td class="paramname">DataSize</td><td>Size of Data found. If size is less than the data, this value contains the required size. </td></tr>
    <tr><td class="paramname">Data</td><td>The buffer to return the contents of the variable. May be NULL with a zero DataSize in order to determine the size buffer needed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>EFI_INVALID_PARAMETER Invalid parameter. </dd>
<dd>
EFI_SUCCESS Find the specified variable. </dd>
<dd>
EFI_NOT_FOUND Not found. </dd>
<dd>
EFI_BUFFER_TO_SMALL DataSize is too small for the result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l02435">2435</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="ab050b35b82d47c13e49489a22a01aa02" name="ab050b35b82d47c13e49489a22a01aa02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab050b35b82d47c13e49489a22a01aa02">&#9670;&#160;</a></span>VariableServiceQueryVariableInfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI VariableServiceQueryVariableInfo </td>
          <td>(</td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>Attributes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT64 *</td>          <td class="paramname"><span class="paramname"><em>MaximumVariableStorageSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT64 *</td>          <td class="paramname"><span class="paramname"><em>RemainingVariableStorageSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT64 *</td>          <td class="paramname"><span class="paramname"><em>MaximumVariableSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This code returns information about the EFI variables.</p>
<p>Caution: This function may receive untrusted input. This function may be invoked in SMM mode. This function will do basic validation, before parse the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Attributes</td><td>Attributes bitmask to specify the type of variables on which to return information. </td></tr>
    <tr><td class="paramname">MaximumVariableStorageSize</td><td>Pointer to the maximum size of the storage space available for the EFI variables associated with the attributes specified. </td></tr>
    <tr><td class="paramname">RemainingVariableStorageSize</td><td>Pointer to the remaining size of the storage space available for EFI variables associated with the attributes specified. </td></tr>
    <tr><td class="paramname">MaximumVariableSize</td><td>Pointer to the maximum size of an individual EFI variables associated with the attributes specified.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>EFI_INVALID_PARAMETER An invalid combination of attribute bits was supplied. </dd>
<dd>
EFI_SUCCESS Query successfully. </dd>
<dd>
EFI_UNSUPPORTED The attribute is not supported on this platform. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l03131">3131</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="ad3a7d9c60d30f1400b9e1c678c80ce72" name="ad3a7d9c60d30f1400b9e1c678c80ce72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3a7d9c60d30f1400b9e1c678c80ce72">&#9670;&#160;</a></span>VariableServiceQueryVariableInfoInternal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI VariableServiceQueryVariableInfoInternal </td>
          <td>(</td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>Attributes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT64 *</td>          <td class="paramname"><span class="paramname"><em>MaximumVariableStorageSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT64 *</td>          <td class="paramname"><span class="paramname"><em>RemainingVariableStorageSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OUT UINT64 *</td>          <td class="paramname"><span class="paramname"><em>MaximumVariableSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This code returns information about the EFI variables.</p>
<p>Caution: This function may receive untrusted input. This function may be invoked in SMM mode. This function will do basic validation, before parse the data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Attributes</td><td>Attributes bitmask to specify the type of variables on which to return information. </td></tr>
    <tr><td class="paramname">MaximumVariableStorageSize</td><td>Pointer to the maximum size of the storage space available for the EFI variables associated with the attributes specified. </td></tr>
    <tr><td class="paramname">RemainingVariableStorageSize</td><td>Pointer to the remaining size of the storage space available for EFI variables associated with the attributes specified. </td></tr>
    <tr><td class="paramname">MaximumVariableSize</td><td>Pointer to the maximum size of an individual EFI variables associated with the attributes specified.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>EFI_SUCCESS Query successfully. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l02951">2951</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="ae3f89de9a5b91a5f2f5c360531717235" name="ae3f89de9a5b91a5f2f5c360531717235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3f89de9a5b91a5f2f5c360531717235">&#9670;&#160;</a></span>VariableServiceSetVariable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS EFIAPI VariableServiceSetVariable </td>
          <td>(</td>
          <td class="paramtype">IN CHAR16 *</td>          <td class="paramname"><span class="paramname"><em>VariableName</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN EFI_GUID *</td>          <td class="paramname"><span class="paramname"><em>VendorGuid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINT32</td>          <td class="paramname"><span class="paramname"><em>Attributes</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN UINTN</td>          <td class="paramname"><span class="paramname"><em>DataSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IN VOID *</td>          <td class="paramname"><span class="paramname"><em>Data</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This code sets variable in storage blocks (Volatile or Non-Volatile).</p>
<p>Caution: This function may receive untrusted input. This function may be invoked in SMM mode, and datasize and data are external input. This function will do basic validation, before parse the data. This function will parse the authentication carefully to avoid security issues, like buffer overflow, integer overflow. This function will check attribute carefully to avoid authentication bypass.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VariableName</td><td>Name of Variable to be found. </td></tr>
    <tr><td class="paramname">VendorGuid</td><td>Variable vendor GUID. </td></tr>
    <tr><td class="paramname">Attributes</td><td>Attribute value of the variable found </td></tr>
    <tr><td class="paramname">DataSize</td><td>Size of Data found. If size is less than the data, this value contains the required size. </td></tr>
    <tr><td class="paramname">Data</td><td>Data pointer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>EFI_INVALID_PARAMETER Invalid parameter. </dd>
<dd>
EFI_SUCCESS Set successfully. </dd>
<dd>
EFI_OUT_OF_RESOURCES Resource not enough to set variable. </dd>
<dd>
EFI_NOT_FOUND Not found. </dd>
<dd>
EFI_WRITE_PROTECTED Variable is read-only. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l02627">2627</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a6d47dd506907d025366155d1c2fa4fcc" name="a6d47dd506907d025366155d1c2fa4fcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d47dd506907d025366155d1c2fa4fcc">&#9670;&#160;</a></span>VariableWriteServiceInitialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_STATUS VariableWriteServiceInitialize </td>
          <td>(</td>
          <td class="paramtype">VOID</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes variable write service.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EFI_SUCCESS</td><td>Function successfully executed. </td></tr>
    <tr><td class="paramname">Others</td><td>Fail to initialize the variable service. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l03426">3426</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a239c0c1136664713bf6fed1d6ed6a0b5" name="a239c0c1136664713bf6fed1d6ed6a0b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a239c0c1136664713bf6fed1d6ed6a0b5">&#9670;&#160;</a></span>gVariableInfo</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VARIABLE_INFO_ENTRY* gVariableInfo = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The memory entry used for variable statistics data. </p>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00051">51</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a31ffcc7e4a1c4380de4365472ad5659b" name="a31ffcc7e4a1c4380de4365472ad5659b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31ffcc7e4a1c4380de4365472ad5659b">&#9670;&#160;</a></span>mAuthContextIn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AUTH_VAR_LIB_CONTEXT_IN mAuthContextIn</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">  AUTH_VAR_LIB_CONTEXT_IN_STRUCT_VERSION,</div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line">  0,</div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line">  0,</div>
<div class="line">  <a class="code hl_function" href="_variable_8h.html#ad7c50e2900466b2249cdac83b9cbfb0d">VariableExLibFindVariable</a>,</div>
<div class="line">  <a class="code hl_function" href="_variable_8h.html#af2dd2513580575722f23edeb5d99a603">VariableExLibFindNextVariable</a>,</div>
<div class="line">  <a class="code hl_function" href="_variable_8h.html#adf252e3de8aa915d253294f241980215">VariableExLibUpdateVariable</a>,</div>
<div class="line">  <a class="code hl_function" href="_variable_8h.html#a3996209ef2064cd537e5a22d13524887">VariableExLibGetScratchBuffer</a>,</div>
<div class="line">  <a class="code hl_function" href="_variable_8h.html#a96f1f681300fa3b5be37eaa7ed364160">VariableExLibCheckRemainingSpaceForConsistency</a>,</div>
<div class="line">  <a class="code hl_function" href="_variable_8h.html#a951ee2ff102336e8271d4feb173e79ff">VariableExLibAtRuntime</a>,</div>
<div class="line">}</div>
<div class="ttc" id="a_variable_8h_html_a3996209ef2064cd537e5a22d13524887"><div class="ttname"><a href="_variable_8h.html#a3996209ef2064cd537e5a22d13524887">VariableExLibGetScratchBuffer</a></div><div class="ttdeci">EFI_STATUS EFIAPI VariableExLibGetScratchBuffer(IN OUT UINTN *ScratchBufferSize, OUT VOID **ScratchBuffer)</div><div class="ttdef"><b>Definition</b> <a href="_variable_ex_lib_8c_source.html#l00189">VariableExLib.c:189</a></div></div>
<div class="ttc" id="a_variable_8h_html_a951ee2ff102336e8271d4feb173e79ff"><div class="ttname"><a href="_variable_8h.html#a951ee2ff102336e8271d4feb173e79ff">VariableExLibAtRuntime</a></div><div class="ttdeci">BOOLEAN EFIAPI VariableExLibAtRuntime(VOID)</div><div class="ttdef"><b>Definition</b> <a href="_variable_ex_lib_8c_source.html#l00253">VariableExLib.c:253</a></div></div>
<div class="ttc" id="a_variable_8h_html_a96f1f681300fa3b5be37eaa7ed364160"><div class="ttname"><a href="_variable_8h.html#a96f1f681300fa3b5be37eaa7ed364160">VariableExLibCheckRemainingSpaceForConsistency</a></div><div class="ttdeci">BOOLEAN EFIAPI VariableExLibCheckRemainingSpaceForConsistency(IN UINT32 Attributes,...)</div><div class="ttdef"><b>Definition</b> <a href="_variable_ex_lib_8c_source.html#l00227">VariableExLib.c:227</a></div></div>
<div class="ttc" id="a_variable_8h_html_ad7c50e2900466b2249cdac83b9cbfb0d"><div class="ttname"><a href="_variable_8h.html#ad7c50e2900466b2249cdac83b9cbfb0d">VariableExLibFindVariable</a></div><div class="ttdeci">EFI_STATUS EFIAPI VariableExLibFindVariable(IN CHAR16 *VariableName, IN EFI_GUID *VendorGuid, OUT AUTH_VARIABLE_INFO *AuthVariableInfo)</div><div class="ttdef"><b>Definition</b> <a href="_variable_ex_lib_8c_source.html#l00032">VariableExLib.c:32</a></div></div>
<div class="ttc" id="a_variable_8h_html_adf252e3de8aa915d253294f241980215"><div class="ttname"><a href="_variable_8h.html#adf252e3de8aa915d253294f241980215">VariableExLibUpdateVariable</a></div><div class="ttdeci">EFI_STATUS EFIAPI VariableExLibUpdateVariable(IN AUTH_VARIABLE_INFO *AuthVariableInfo)</div><div class="ttdef"><b>Definition</b> <a href="_variable_ex_lib_8c_source.html#l00155">VariableExLib.c:155</a></div></div>
<div class="ttc" id="a_variable_8h_html_af2dd2513580575722f23edeb5d99a603"><div class="ttname"><a href="_variable_8h.html#af2dd2513580575722f23edeb5d99a603">VariableExLibFindNextVariable</a></div><div class="ttdeci">EFI_STATUS EFIAPI VariableExLibFindNextVariable(IN CHAR16 *VariableName, IN EFI_GUID *VendorGuid, OUT AUTH_VARIABLE_INFO *AuthVariableInfo)</div><div class="ttdef"><b>Definition</b> <a href="_variable_ex_lib_8c_source.html#l00092">VariableExLib.c:92</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00083">83</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a41e5334885fd8dbf42c51a10545ee63f" name="a41e5334885fd8dbf42c51a10545ee63f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41e5334885fd8dbf42c51a10545ee63f">&#9670;&#160;</a></span>mAuthContextOut</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">AUTH_VAR_LIB_CONTEXT_OUT mAuthContextOut</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00101">101</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a4f9f67f9ac4302e30e0e03bdce06034b" name="a4f9f67f9ac4302e30e0e03bdce06034b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f9f67f9ac4302e30e0e03bdce06034b">&#9670;&#160;</a></span>mCurrentBootVarErrFlag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VAR_ERROR_FLAG mCurrentBootVarErrFlag = VAR_ERROR_FLAG_NO_ERROR</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00067">67</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a0c81c84647eda976ac0e130c7126b970" name="a0c81c84647eda976ac0e130c7126b970"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c81c84647eda976ac0e130c7126b970">&#9670;&#160;</a></span>mEndOfDxe</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOLEAN mEndOfDxe = FALSE</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The flag to indicate whether the platform has left the DXE phase of execution. </p>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00056">56</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a027219dab86d5521639b81968485f44b" name="a027219dab86d5521639b81968485f44b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a027219dab86d5521639b81968485f44b">&#9670;&#160;</a></span>mNvFvHeaderCache</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EFI_FIRMWARE_VOLUME_HEADER* mNvFvHeaderCache = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Memory cache of Fv Header. </p>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00046">46</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="a644cd901e32eee1a899fefc2cca562c2" name="a644cd901e32eee1a899fefc2cca562c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a644cd901e32eee1a899fefc2cca562c2">&#9670;&#160;</a></span>mNvVariableCache</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VARIABLE_STORE_HEADER* mNvVariableCache = NULL</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Define a memory cache that improves the search performance for a variable. For EmuNvMode == TRUE, it will be equal to NonVolatileVariableBase. </p>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00041">41</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="aa8f67c980ff7857b099f1d27df4a40d6" name="aa8f67c980ff7857b099f1d27df4a40d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8f67c980ff7857b099f1d27df4a40d6">&#9670;&#160;</a></span>mRequestSource</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VAR_CHECK_REQUEST_SOURCE mRequestSource = VarCheckFromUntrusted</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>It indicates the var check request source. In the implementation, DXE is regarded as untrusted, and SMM is trusted. </p>

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00062">62</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="abaebbf98a4d969c243f865bb03acb898" name="abaebbf98a4d969c243f865bb03acb898"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaebbf98a4d969c243f865bb03acb898">&#9670;&#160;</a></span>mVariableEntryProperty</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VARIABLE_ENTRY_PROPERTY mVariableEntryProperty[]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">  {</div>
<div class="line">    &amp;gEdkiiVarErrorFlagGuid,</div>
<div class="line">    VAR_ERROR_FLAG_NAME,</div>
<div class="line">    {</div>
<div class="line">      VAR_CHECK_VARIABLE_PROPERTY_REVISION,</div>
<div class="line">      VAR_CHECK_VARIABLE_PROPERTY_READ_ONLY,</div>
<div class="line">      VARIABLE_ATTRIBUTE_NV_BS_RT,</div>
<div class="line">      <span class="keyword">sizeof</span> (VAR_ERROR_FLAG),</div>
<div class="line">      <span class="keyword">sizeof</span> (VAR_ERROR_FLAG)</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">}</div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00069">69</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
<a id="adc82f6c4da89c6c394296c7603f26509" name="adc82f6c4da89c6c394296c7603f26509"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc82f6c4da89c6c394296c7603f26509">&#9670;&#160;</a></span>mVariableModuleGlobal</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_v_a_r_i_a_b_l_e___m_o_d_u_l_e___g_l_o_b_a_l.html">VARIABLE_MODULE_GLOBAL</a>* mVariableModuleGlobal</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_variable_8c_source.html#l00035">35</a> of file <a class="el" href="_variable_8c_source.html">Variable.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_46f0a310448968fe371c870cd868aa1f.html">Platform</a></li><li class="navelem"><a class="el" href="dir_2721e2b3ed45f8a6318d9316243ecd2b.html">OpenVariableRuntimeDxe</a></li><li class="navelem"><a class="el" href="_variable_8c.html">Variable.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
    toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
    toggleButton.title = "Toggle Light/Dark Mode"
    $(document).ready(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
    // every resize will remove the button, which is why it has to be added again:
    $(window).resize(function(){
      document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
    })
  })
</script>
</body>
</html>
